<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="cyCONDOR">
<title>Pseudotime analysis • cyCONDOR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Pseudotime analysis">
<meta property="og:description" content="cyCONDOR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">cyCONDOR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/cyCONDOR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Prepare_data_for_cyCONDOR_analysis.html">Prepare data for cyCONDOR analysis</a>
    <a class="dropdown-item" href="../articles/How_to_run_cyCONDOR_as_container.html">How to run cyCONDOR as container</a>
    <a class="dropdown-item" href="../articles/Data_Loading_and_Transformation.html">Data Loading and Transformation</a>
    <a class="dropdown-item" href="../articles/Load_a_FlowJo_workspace.html">Load a FlowJo workspace</a>
    <a class="dropdown-item" href="../articles/Dimensionality_Reduction.html">Dimensionality Reduction</a>
    <a class="dropdown-item" href="../articles/Clustering_and_cell_annotation.html">Clustering and cell annotation</a>
    <a class="dropdown-item" href="../articles/Batch_correction.html">Batch correction</a>
    <a class="dropdown-item" href="../articles/Data_Visualization.html">Data Visualization</a>
    <a class="dropdown-item" href="../articles/Differential_Analysis.html">Differential Analysis with cyCONDOR</a>
    <a class="dropdown-item" href="../articles/Pseudotime_analysis.html">Pseudotime analysis</a>
    <a class="dropdown-item" href="../articles/Data_Projection.html">Data Projection</a>
    <a class="dropdown-item" href="../articles/Machine_learning_classifier.html">Machine learning classifier</a>
    <a class="dropdown-item" href="../articles/Cell_type_prediction.html">Cell type prediction</a>
    <a class="dropdown-item" href="../articles/Other_utilities.html">Introduction to the condor object and other utilities</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lorenzobonaguro/condor/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Pseudotime analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lorenzobonaguro/condor/blob/HEAD/vignettes/Pseudotime_analysis.Rmd" class="external-link"><code>vignettes/Pseudotime_analysis.Rmd</code></a></small>
      <div class="d-none name"><code>Pseudotime_analysis.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lorenzobonaguro/condor" class="external-link">cyCONDOR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">pheatmap</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<p>With <code>cyCONDOR</code> we implemented <code>slingshot</code> for
pseudotome analysis, following a workflow to calculate trajectories and
pseudotime.</p>
<p>This workflow can be applied to any type of HDFC data, nevertheless
the interpretation of trajectories and preudotime should always be
validated by other experiment of domain knowledge. We exemplified here
with a subset of the cyTOF dataset from <a href="https://www.science.org/doi/10.1126/science.1198704" class="external-link">Bendall et
al. 2011</a></p>
<p>If you use this workflow in your work please consider citing <a href="XXX">cyCONDOR</a> and <a href="https://bmcgenomics.biomedcentral.com/articles/10.1186/s12864-018-4772-0" class="external-link">Street
et al. (2018)</a>.</p>
<p>cyCONDOR implementation of <code>slingshot</code> follows the
tutorial from the <a href="https://nbisweden.github.io/workshop-archive/workshop-scRNAseq/2020-01-27/labs/compiled/slingshot/slingshot.html" class="external-link">NBIS
tutorial</a></p>
<div class="section level3">
<h3 id="load-an-example-dataset">Load an example dataset<a class="anchor" aria-label="anchor" href="#load-an-example-dataset"></a>
</h3>
<p>We start here by loading an example <code>condor</code> object
already annotated.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"../.test_files/condor_pseudotime_016.rds"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dim_red.html">plot_dim_red</a></span><span class="op">(</span>fcd<span class="op">=</span> <span class="va">condor</span>,  </span>
<span>             expr_slot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             reduction_method <span class="op">=</span> <span class="st">"umap"</span>, </span>
<span>             reduction_slot <span class="op">=</span> <span class="st">"pca_orig"</span>, </span>
<span>             cluster_slot <span class="op">=</span> <span class="st">"phenograph_filter_pca_orig_k_10"</span>,</span>
<span>             param <span class="op">=</span> <span class="st">"metaclusters"</span>,</span>
<span>             title <span class="op">=</span> <span class="st">"UMAP colored by Phenograph"</span>,</span>
<span>             alpha<span class="op">=</span> <span class="fl">1</span>, dot_size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="Pseudotime_analysis_files/figure-html/unnamed-chunk-2-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_marker_HM.html">plot_marker_HM</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor</span>,</span>
<span>               expr_slot <span class="op">=</span> <span class="st">"orig"</span>,</span>
<span>               cluster_slot <span class="op">=</span> <span class="st">"phenograph_filter_pca_orig_k_10"</span>,</span>
<span>               cluster_var <span class="op">=</span> <span class="st">"metaclusters"</span>,</span>
<span>               cluster_rows <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               cluster_cols <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>               title<span class="op">=</span> <span class="st">"Marker expression Phenograph clustering"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Pseudotime_analysis_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="pseudotime-analysis">Pseudotime analysis<a class="anchor" aria-label="anchor" href="#pseudotime-analysis"></a>
</h2>
<p>We can now calculate the pseudotime with different settings:</p>
<div class="section level3">
<h3 id="with-no-constrains-on-the-start-of-the-trajectory">With no constrains on the start of the trajectory<a class="anchor" aria-label="anchor" href="#with-no-constrains-on-the-start-of-the-trajectory"></a>
</h3>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runPseudotime.html">runPseudotime</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor</span>, </span>
<span>                        reduction_method <span class="op">=</span> <span class="st">"umap"</span>,</span>
<span>                        reduction_slot <span class="op">=</span> <span class="st">"pca_orig"</span>,</span>
<span>                        cluster_slot<span class="op">=</span> <span class="st">"phenograph_filter_pca_orig_k_10"</span>,</span>
<span>                        cluster_var <span class="op">=</span> <span class="st">"metaclusters"</span>,</span>
<span>                        approx_points <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Slingshot - getLineages"</span></span>
<span><span class="co">## [1] "Slingshot - getCurves"</span></span></code></pre>
<p>The output of is saved in
<code>condor$pseudotime$slingshot_umap_pca_orig</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor</span><span class="op">$</span><span class="va">pseudotime</span><span class="op">$</span><span class="va">slingshot_umap_pca_orig</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##                                               Lineage1 Lineage2      mean</span></span>
<span><span class="co">## export_Marrow1_00_SurfaceOnly_singlets.fcs_2  8.907685       NA  8.907685</span></span>
<span><span class="co">## export_Marrow1_00_SurfaceOnly_singlets.fcs_9        NA 11.40754 11.407538</span></span>
<span><span class="co">## export_Marrow1_00_SurfaceOnly_singlets.fcs_18       NA 12.15903 12.159027</span></span>
<span><span class="co">## export_Marrow1_00_SurfaceOnly_singlets.fcs_27       NA 11.36649 11.366492</span></span>
<span><span class="co">## export_Marrow1_00_SurfaceOnly_singlets.fcs_49       NA 11.36649 11.366492</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="with-a-specific-starting-cluster">With a specific starting cluster<a class="anchor" aria-label="anchor" href="#with-a-specific-starting-cluster"></a>
</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runPseudotime.html">runPseudotime</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor</span>, </span>
<span>                        reduction_method <span class="op">=</span> <span class="st">"umap"</span>,</span>
<span>                        reduction_slot <span class="op">=</span> <span class="st">"pca_orig"</span>,</span>
<span>                        cluster_slot<span class="op">=</span> <span class="st">"phenograph_filter_pca_orig_k_10"</span>,</span>
<span>                        cluster_var <span class="op">=</span> <span class="st">"metaclusters"</span>,</span>
<span>                        approx_points <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                        start.clus <span class="op">=</span>  <span class="st">"CMPs"</span>,<span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Slingshot - getLineages"</span></span>
<span><span class="co">## [1] "Slingshot - getCurves"</span></span></code></pre>
<p>The output of is saved in
<code>condor$pseudotime$slingshot_umap_pca_orig_CMPs</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor</span><span class="op">$</span><span class="va">pseudotime</span><span class="op">$</span><span class="va">slingshot_umap_pca_orig_CMPs</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##                                               Lineage1 Lineage2 Lineage3</span></span>
<span><span class="co">## export_Marrow1_00_SurfaceOnly_singlets.fcs_2        NA 6.205366       NA</span></span>
<span><span class="co">## export_Marrow1_00_SurfaceOnly_singlets.fcs_9        NA       NA 6.238479</span></span>
<span><span class="co">## export_Marrow1_00_SurfaceOnly_singlets.fcs_18       NA       NA 7.201946</span></span>
<span><span class="co">## export_Marrow1_00_SurfaceOnly_singlets.fcs_27       NA       NA 5.609041</span></span>
<span><span class="co">## export_Marrow1_00_SurfaceOnly_singlets.fcs_49       NA       NA 5.388332</span></span>
<span><span class="co">##                                                   mean</span></span>
<span><span class="co">## export_Marrow1_00_SurfaceOnly_singlets.fcs_2  6.205366</span></span>
<span><span class="co">## export_Marrow1_00_SurfaceOnly_singlets.fcs_9  6.238479</span></span>
<span><span class="co">## export_Marrow1_00_SurfaceOnly_singlets.fcs_18 7.201946</span></span>
<span><span class="co">## export_Marrow1_00_SurfaceOnly_singlets.fcs_27 5.609041</span></span>
<span><span class="co">## export_Marrow1_00_SurfaceOnly_singlets.fcs_49 5.388332</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="testing-all-clusters-as-starting-point">Testing all clusters as starting point<a class="anchor" aria-label="anchor" href="#testing-all-clusters-as-starting-point"></a>
</h3>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">condor</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">phenograph_filter_pca_orig_k_10</span><span class="op">$</span><span class="va">metaclusters</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>  </span>
<span>  <span class="va">condor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runPseudotime.html">runPseudotime</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor</span>, </span>
<span>                          reduction_method <span class="op">=</span> <span class="st">"umap"</span>,</span>
<span>                          reduction_slot <span class="op">=</span> <span class="st">"pca_orig"</span>,</span>
<span>                          cluster_slot<span class="op">=</span> <span class="st">"phenograph_filter_pca_orig_k_10"</span>,</span>
<span>                          cluster_var <span class="op">=</span> <span class="st">"metaclusters"</span>,</span>
<span>                          approx_points <span class="op">=</span> <span class="fl">5</span>,</span>
<span>                          start.clus <span class="op">=</span>  <span class="va">i</span><span class="op">)</span></span>
<span>  </span>
<span><span class="op">}</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "Slingshot - getLineages"</span></span>
<span><span class="co">## [1] "Slingshot - getCurves"</span></span>
<span><span class="co">## [1] "Slingshot - getLineages"</span></span>
<span><span class="co">## [1] "Slingshot - getCurves"</span></span>
<span><span class="co">## [1] "Slingshot - getLineages"</span></span>
<span><span class="co">## [1] "Slingshot - getCurves"</span></span>
<span><span class="co">## [1] "Slingshot - getLineages"</span></span>
<span><span class="co">## [1] "Slingshot - getCurves"</span></span>
<span><span class="co">## [1] "Slingshot - getLineages"</span></span>
<span><span class="co">## [1] "Slingshot - getCurves"</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="visualize-the-result-of-slingshot-analysis">Visualize the result of <code>slingshot</code> analysis<a class="anchor" aria-label="anchor" href="#visualize-the-result-of-slingshot-analysis"></a>
</h3>
<p>It is possible to use the <code>plot_dim_red</code> function to plot
the result of pseudotime analysis overlayed on the UMAP coordinates.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dim_red.html">plot_dim_red</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor</span>, </span>
<span>             expr_slot <span class="op">=</span> <span class="st">"orig"</span>, </span>
<span>             reduction_method <span class="op">=</span> <span class="st">"umap"</span>, </span>
<span>             reduction_slot <span class="op">=</span> <span class="st">"pca_orig"</span>, </span>
<span>             cluster_slot <span class="op">=</span> <span class="st">"phenograph_filter_pca_orig_k_10"</span>, </span>
<span>             add_pseudotime <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>             pseudotime_slot <span class="op">=</span> <span class="st">"slingshot_umap_pca_orig"</span>,</span>
<span>             param <span class="op">=</span> <span class="st">"mean"</span>, </span>
<span>             order <span class="op">=</span> <span class="cn">T</span>, </span>
<span>             title <span class="op">=</span> <span class="st">"UMAP colored by pseudotime"</span>, </span>
<span>             facet_by_variable <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>             raster <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>             alpha <span class="op">=</span> <span class="fl">1</span>, </span>
<span>             dot_size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_path</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">condor</span><span class="op">$</span><span class="va">extras</span><span class="op">$</span><span class="va">slingshot_umap_pca_orig</span><span class="op">$</span><span class="va">lineages</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="va">Order</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>group <span class="op">=</span> <span class="va">Lineage</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning: Using `size` aesthetic for lines was deprecated in ggplot2 3.4.0.</span></span>
<span><span class="co">## <span style="color: #00BBBB;">ℹ</span> Please use `linewidth` instead.</span></span>
<span><span class="co">## <span style="color: #555555;">This warning is displayed once every 8 hours.</span></span></span>
<span><span class="co">## <span style="color: #555555;">Call `lifecycle::last_lifecycle_warnings()` to see where this warning was</span></span></span>
<span><span class="co">## <span style="color: #555555;">generated.</span></span></span></code></pre>
<p><img src="Pseudotime_analysis_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="heatmap-visualization-of-monocytes-trajectory">Heatmap visualization of monocytes trajectory<a class="anchor" aria-label="anchor" href="#heatmap-visualization-of-monocytes-trajectory"></a>
</h2>
<p>We provide here some custom code to visualize the pseudotime,
nevertheless many visualization can be performed on this data depending
on the biological question.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">selections</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">condor</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">phenograph_filter_pca_orig_k_10</span><span class="op">[</span><span class="va">condor</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">phenograph_filter_pca_orig_k_10</span><span class="op">$</span><span class="va">metaclusters</span> <span class="op"><a href="https://rdrr.io/pkg/BiocGenerics/man/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"HSCs"</span>, <span class="st">"CMPs"</span>, <span class="st">"Myeloblast"</span>, <span class="st">"Monocytes"</span><span class="op">)</span>, <span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">condor_mono</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_fcd.html">filter_fcd</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor</span>,</span>
<span>                            cell_ids <span class="op">=</span> <span class="va">selections</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">expression</span> <span class="op">&lt;-</span> <span class="va">condor_mono</span><span class="op">$</span><span class="va">expr</span><span class="op">$</span><span class="va">orig</span></span>
<span></span>
<span><span class="va">anno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">condor_mono</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">phenograph_filter_pca_orig_k_10</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Phenograph"</span>, <span class="st">"metaclusters"</span><span class="op">)</span><span class="op">]</span>, <span class="va">condor_mono</span><span class="op">$</span><span class="va">pseudotime</span><span class="op">$</span><span class="va">slingshot_umap_pca_orig</span><span class="op">)</span></span>
<span></span>
<span><span class="va">anno</span> <span class="op">&lt;-</span> <span class="va">anno</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/order.html" class="external-link">order</a></span><span class="op">(</span><span class="va">anno</span><span class="op">$</span><span class="va">Lineage2</span>, decreasing <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>,<span class="op">]</span></span>
<span></span>
<span><span class="va">expression</span> <span class="op">&lt;-</span> <span class="va">expression</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">anno</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"148-CD34"</span>, <span class="st">"160-CD14"</span>, <span class="st">"144-CD11b"</span><span class="op">)</span><span class="op">]</span></span>
<span></span>
<span><span class="va">my_colour</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>metaclusters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>Monocytes <span class="op">=</span> <span class="st">"#CBD588"</span>, HSCs <span class="op">=</span> <span class="st">"#689030"</span>, Myeloblast <span class="op">=</span> <span class="st">"#DA5724"</span>, CMPs <span class="op">=</span> <span class="st">"#F7941D"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/pheatmap/man/pheatmap.html" class="external-link">pheatmap</a></span><span class="op">(</span>mat <span class="op">=</span> <span class="va">expression</span>, </span>
<span>         scale <span class="op">=</span> <span class="st">"column"</span>, </span>
<span>         show_rownames <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>         cluster_rows <span class="op">=</span> <span class="cn">F</span>, </span>
<span>         cluster_cols <span class="op">=</span> <span class="cn">F</span>, </span>
<span>         annotation_row <span class="op">=</span> <span class="va">anno</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"metaclusters"</span>, <span class="st">"Lineage2"</span><span class="op">)</span><span class="op">]</span>, </span>
<span>         annotation_colors <span class="op">=</span> <span class="va">my_colour</span>, </span>
<span>         breaks <span class="op">=</span> <span class="fu"><a href="../reference/scaleColors.html">scaleColors</a></span><span class="op">(</span><span class="va">expression</span>, maxvalue <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">[[</span><span class="st">"breaks"</span><span class="op">]</span><span class="op">]</span>, </span>
<span>         color <span class="op">=</span> <span class="fu"><a href="../reference/scaleColors.html">scaleColors</a></span><span class="op">(</span><span class="va">expression</span>, maxvalue <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">[[</span><span class="st">"color"</span><span class="op">]</span><span class="op">]</span>, main <span class="op">=</span> <span class="st">"Figure 4f - Heatmap Monocytes pseudotime"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Pseudotime_analysis_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">info</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Etc/UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] dplyr_1.1.3     ggplot2_3.4.4   pheatmap_1.0.12 cyCONDOR_0.1.6 </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] IRanges_2.34.1              Rmisc_1.5.1                </span></span>
<span><span class="co">##   [3] urlchecker_1.0.1            nnet_7.3-19                </span></span>
<span><span class="co">##   [5] CytoNorm_2.0.1              TH.data_1.1-2              </span></span>
<span><span class="co">##   [7] vctrs_0.6.4                 digest_0.6.33              </span></span>
<span><span class="co">##   [9] png_0.1-8                   shape_1.4.6                </span></span>
<span><span class="co">##  [11] proxy_0.4-27                slingshot_2.8.0            </span></span>
<span><span class="co">##  [13] ggrepel_0.9.4               parallelly_1.36.0          </span></span>
<span><span class="co">##  [15] MASS_7.3-60                 pkgdown_2.0.7              </span></span>
<span><span class="co">##  [17] reshape2_1.4.4              httpuv_1.6.12              </span></span>
<span><span class="co">##  [19] foreach_1.5.2               BiocGenerics_0.46.0        </span></span>
<span><span class="co">##  [21] withr_2.5.1                 ggrastr_1.0.2              </span></span>
<span><span class="co">##  [23] xfun_0.40                   ggpubr_0.6.0               </span></span>
<span><span class="co">##  [25] ellipsis_0.3.2              survival_3.5-7             </span></span>
<span><span class="co">##  [27] memoise_2.0.1               hexbin_1.28.3              </span></span>
<span><span class="co">##  [29] ggbeeswarm_0.7.2            RProtoBufLib_2.12.1        </span></span>
<span><span class="co">##  [31] princurve_2.1.6             profvis_0.3.8              </span></span>
<span><span class="co">##  [33] ggsci_3.0.0                 systemfonts_1.0.5          </span></span>
<span><span class="co">##  [35] ragg_1.2.6                  zoo_1.8-12                 </span></span>
<span><span class="co">##  [37] GlobalOptions_0.1.2         DEoptimR_1.1-3             </span></span>
<span><span class="co">##  [39] Formula_1.2-5               prettyunits_1.2.0          </span></span>
<span><span class="co">##  [41] promises_1.2.1              scatterplot3d_0.3-44       </span></span>
<span><span class="co">##  [43] rstatix_0.7.2               globals_0.16.2             </span></span>
<span><span class="co">##  [45] ps_1.7.5                    rstudioapi_0.15.0          </span></span>
<span><span class="co">##  [47] miniUI_0.1.1.1              generics_0.1.3             </span></span>
<span><span class="co">##  [49] ggcyto_1.28.1               base64enc_0.1-3            </span></span>
<span><span class="co">##  [51] processx_3.8.2              curl_5.1.0                 </span></span>
<span><span class="co">##  [53] S4Vectors_0.38.2            zlibbioc_1.46.0            </span></span>
<span><span class="co">##  [55] flowWorkspace_4.12.2        polyclip_1.10-6            </span></span>
<span><span class="co">##  [57] randomForest_4.7-1.1        GenomeInfoDbData_1.2.10    </span></span>
<span><span class="co">##  [59] RBGL_1.76.0                 ncdfFlow_2.46.0            </span></span>
<span><span class="co">##  [61] RcppEigen_0.3.3.9.4         xtable_1.8-4               </span></span>
<span><span class="co">##  [63] stringr_1.5.0               desc_1.4.2                 </span></span>
<span><span class="co">##  [65] doParallel_1.0.17           evaluate_0.22              </span></span>
<span><span class="co">##  [67] S4Arrays_1.0.6              hms_1.1.3                  </span></span>
<span><span class="co">##  [69] glmnet_4.1-8                GenomicRanges_1.52.1       </span></span>
<span><span class="co">##  [71] irlba_2.3.5.1               colorspace_2.1-0           </span></span>
<span><span class="co">##  [73] harmony_1.1.0               reticulate_1.34.0          </span></span>
<span><span class="co">##  [75] readxl_1.4.3                magrittr_2.0.3             </span></span>
<span><span class="co">##  [77] lmtest_0.9-40               readr_2.1.4                </span></span>
<span><span class="co">##  [79] Rgraphviz_2.44.0            later_1.3.1                </span></span>
<span><span class="co">##  [81] lattice_0.22-5              future.apply_1.11.0        </span></span>
<span><span class="co">##  [83] robustbase_0.99-0           XML_3.99-0.15              </span></span>
<span><span class="co">##  [85] cowplot_1.1.1               matrixStats_1.1.0          </span></span>
<span><span class="co">##  [87] xts_0.13.1                  class_7.3-22               </span></span>
<span><span class="co">##  [89] Hmisc_5.1-1                 pillar_1.9.0               </span></span>
<span><span class="co">##  [91] nlme_3.1-163                iterators_1.0.14           </span></span>
<span><span class="co">##  [93] compiler_4.3.1              RSpectra_0.16-1            </span></span>
<span><span class="co">##  [95] stringi_1.7.12              gower_1.0.1                </span></span>
<span><span class="co">##  [97] minqa_1.2.6                 SummarizedExperiment_1.30.2</span></span>
<span><span class="co">##  [99] lubridate_1.9.3             devtools_2.4.5             </span></span>
<span><span class="co">## [101] CytoML_2.12.0               plyr_1.8.9                 </span></span>
<span><span class="co">## [103] crayon_1.5.2                abind_1.4-5                </span></span>
<span><span class="co">## [105] locfit_1.5-9.8              sp_2.1-1                   </span></span>
<span><span class="co">## [107] sandwich_3.0-2              pcaMethods_1.92.0          </span></span>
<span><span class="co">## [109] codetools_0.2-19            multcomp_1.4-25            </span></span>
<span><span class="co">## [111] textshaping_0.3.7           recipes_1.0.8              </span></span>
<span><span class="co">## [113] openssl_2.1.1               Rphenograph_0.99.1         </span></span>
<span><span class="co">## [115] TTR_0.24.3                  bslib_0.5.1                </span></span>
<span><span class="co">## [117] e1071_1.7-13                destiny_3.14.0             </span></span>
<span><span class="co">## [119] GetoptLong_1.0.5            ggplot.multistats_1.0.0    </span></span>
<span><span class="co">## [121] mime_0.12                   splines_4.3.1              </span></span>
<span><span class="co">## [123] circlize_0.4.15             Rcpp_1.0.11                </span></span>
<span><span class="co">## [125] sparseMatrixStats_1.12.2    cellranger_1.1.0           </span></span>
<span><span class="co">## [127] knitr_1.44                  utf8_1.2.4                 </span></span>
<span><span class="co">## [129] clue_0.3-65                 lme4_1.1-35.1              </span></span>
<span><span class="co">## [131] fs_1.6.3                    listenv_0.9.0              </span></span>
<span><span class="co">## [133] checkmate_2.3.0             DelayedMatrixStats_1.22.6  </span></span>
<span><span class="co">## [135] pkgbuild_1.4.2              ggsignif_0.6.4             </span></span>
<span><span class="co">## [137] tibble_3.2.1                Matrix_1.6-1.1             </span></span>
<span><span class="co">## [139] rpart.plot_3.1.1            callr_3.7.3                </span></span>
<span><span class="co">## [141] tzdb_0.4.0                  tweenr_2.0.2               </span></span>
<span><span class="co">## [143] pkgconfig_2.0.3             tools_4.3.1                </span></span>
<span><span class="co">## [145] cachem_1.0.8                smoother_1.1               </span></span>
<span><span class="co">## [147] fastmap_1.1.1               rmarkdown_2.25             </span></span>
<span><span class="co">## [149] scales_1.2.1                grid_4.3.1                 </span></span>
<span><span class="co">## [151] usethis_2.2.2               broom_1.0.5                </span></span>
<span><span class="co">## [153] sass_0.4.7                  graph_1.78.0               </span></span>
<span><span class="co">## [155] carData_3.0-5               RANN_2.6.1                 </span></span>
<span><span class="co">## [157] rpart_4.1.21                farver_2.1.1               </span></span>
<span><span class="co">## [159] yaml_2.3.7                  MatrixGenerics_1.12.3      </span></span>
<span><span class="co">## [161] foreign_0.8-85              ggthemes_4.2.4             </span></span>
<span><span class="co">## [163] cli_3.6.1                   purrr_1.0.2                </span></span>
<span><span class="co">## [165] stats4_4.3.1                lifecycle_1.0.3            </span></span>
<span><span class="co">## [167] uwot_0.1.16                 askpass_1.2.0              </span></span>
<span><span class="co">## [169] caret_6.0-94                Biobase_2.60.0             </span></span>
<span><span class="co">## [171] mvtnorm_1.2-3               lava_1.7.3                 </span></span>
<span><span class="co">## [173] sessioninfo_1.2.2           backports_1.4.1            </span></span>
<span><span class="co">## [175] cytolib_2.12.1              timechange_0.2.0           </span></span>
<span><span class="co">## [177] gtable_0.3.4                rjson_0.2.21               </span></span>
<span><span class="co">## [179] umap_0.2.10.0               ggridges_0.5.4             </span></span>
<span><span class="co">## [181] parallel_4.3.1              pROC_1.18.5                </span></span>
<span><span class="co">## [183] limma_3.56.2                jsonlite_1.8.7             </span></span>
<span><span class="co">## [185] edgeR_3.42.4                RcppHNSW_0.5.0             </span></span>
<span><span class="co">## [187] bitops_1.0-7                Rtsne_0.16                 </span></span>
<span><span class="co">## [189] FlowSOM_2.8.0               ranger_0.16.0              </span></span>
<span><span class="co">## [191] flowCore_2.12.2             jquerylib_0.1.4            </span></span>
<span><span class="co">## [193] timeDate_4022.108           shiny_1.7.5.1              </span></span>
<span><span class="co">## [195] ConsensusClusterPlus_1.64.0 htmltools_0.5.6.1          </span></span>
<span><span class="co">## [197] diffcyt_1.20.0              glue_1.6.2                 </span></span>
<span><span class="co">## [199] XVector_0.40.0              VIM_6.2.2                  </span></span>
<span><span class="co">## [201] RCurl_1.98-1.13             rprojroot_2.0.3            </span></span>
<span><span class="co">## [203] gridExtra_2.3               boot_1.3-28.1              </span></span>
<span><span class="co">## [205] TrajectoryUtils_1.8.0       igraph_1.5.1               </span></span>
<span><span class="co">## [207] R6_2.5.1                    tidyr_1.3.0                </span></span>
<span><span class="co">## [209] SingleCellExperiment_1.22.0 labeling_0.4.3             </span></span>
<span><span class="co">## [211] vcd_1.4-11                  cluster_2.1.4              </span></span>
<span><span class="co">## [213] pkgload_1.3.3               GenomeInfoDb_1.36.4        </span></span>
<span><span class="co">## [215] ipred_0.9-14                nloptr_2.0.3               </span></span>
<span><span class="co">## [217] DelayedArray_0.26.7         tidyselect_1.2.0           </span></span>
<span><span class="co">## [219] vipor_0.4.5                 htmlTable_2.4.2            </span></span>
<span><span class="co">## [221] ggforce_0.4.1               CytoDx_1.20.0              </span></span>
<span><span class="co">## [223] car_3.1-2                   future_1.33.0              </span></span>
<span><span class="co">## [225] ModelMetrics_1.2.2.2        munsell_0.5.0              </span></span>
<span><span class="co">## [227] laeken_0.5.2                data.table_1.14.8          </span></span>
<span><span class="co">## [229] htmlwidgets_1.6.2           ComplexHeatmap_2.16.0      </span></span>
<span><span class="co">## [231] RColorBrewer_1.1-3          rlang_1.1.1                </span></span>
<span><span class="co">## [233] remotes_2.4.2.1             colorRamps_2.3.1           </span></span>
<span><span class="co">## [235] Cairo_1.6-1                 ggnewscale_0.4.9           </span></span>
<span><span class="co">## [237] fansi_1.0.5                 hardhat_1.3.0              </span></span>
<span><span class="co">## [239] beeswarm_0.4.0              prodlim_2023.08.28</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Lorenzo Bonaguro, Charlotte Kroeger, Sophie Mueller, Jacqueline Leidner.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
