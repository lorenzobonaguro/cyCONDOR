<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="cyCONDOR">
<title>Data Projection â€¢ cyCONDOR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Data Projection">
<meta property="og:description" content="cyCONDOR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">cyCONDOR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/cyCONDOR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Prepare_data_for_cyCONDOR_analysis.html">Prepare data for cyCONDOR analysis</a>
    <a class="dropdown-item" href="../articles/How_to_run_cyCONDOR_as_container.html">How to run cyCONDOR as container</a>
    <a class="dropdown-item" href="../articles/Data_Loading_and_Transformation.html">Data Loading and Transformation</a>
    <a class="dropdown-item" href="../articles/Load_a_FlowJo_workspace.html">Load a FlowJo workspace</a>
    <a class="dropdown-item" href="../articles/Dimensionality_Reduction.html">Dimensionality Reduction</a>
    <a class="dropdown-item" href="../articles/Clustering_and_cell_annotation.html">Clustering and cell annotation</a>
    <a class="dropdown-item" href="../articles/Batch_correction.html">Batch correction</a>
    <a class="dropdown-item" href="../articles/Data_Visualization.html">Data Visualization</a>
    <a class="dropdown-item" href="../articles/Differential_Analysis.html">Differential Analysis with cyCONDOR</a>
    <a class="dropdown-item" href="../articles/Pseudotime_analysis.html">Pseudotime analysis</a>
    <a class="dropdown-item" href="../articles/Data_Projection.html">Data Projection</a>
    <a class="dropdown-item" href="../articles/Machine_learning_classifier.html">Machine learning classifier</a>
    <a class="dropdown-item" href="../articles/Cell_type_prediction.html">Cell type prediction</a>
    <a class="dropdown-item" href="../articles/Other_utilities.html">Introduction to the condor object and other utilities</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lorenzobonaguro/condor/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Data Projection</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lorenzobonaguro/condor/blob/HEAD/vignettes/Data_Projection.Rmd" class="external-link"><code>vignettes/Data_Projection.Rmd</code></a></small>
      <div class="d-none name"><code>Data_Projection.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lorenzobonaguro/condor" class="external-link">cyCONDOR</a></span><span class="op">)</span></span></code></pre></div>
<p>Considering the high number of samples that can be generated with
modern HDC instruments and the number of cells acquired we developed a
data projection workflow in <code>cyCONDOR</code>. With this approach an
initial model it trained including a UMAP dimensionality reduction and a
cell classifier of the cell labels. We can then project any new sample
into the pre-trained model, this operation is much faster and allows to
analyse millions of cell in few minutes.</p>
<div class="section level2">
<h2 id="loading-the-data-for-training">Loading the data for training<a class="anchor" aria-label="anchor" href="#loading-the-data-for-training"></a>
</h2>
<p>We start by loading the data for the training.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_fcd.html">prep_fcd</a></span><span class="op">(</span>data_path <span class="op">=</span> <span class="st">"../../../Figure 6 - Data Projection/data_and_envs/fcs_train/"</span>, </span>
<span>                         max_cell <span class="op">=</span> <span class="fl">5000</span>, </span>
<span>                         useCSV <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                         transformation <span class="op">=</span> <span class="st">"auto_logi"</span>, </span>
<span>                         remove_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FSC-H"</span>, <span class="st">"SSC-H"</span>, <span class="st">"FSC-W"</span>, <span class="st">"SSC-W"</span>, <span class="st">"Time"</span>, <span class="st">"live_dead"</span><span class="op">)</span>, </span>
<span>                         anno_table <span class="op">=</span> <span class="st">"../../../Figure 6 - Data Projection/data_and_envs/metadata_train.csv"</span>, </span>
<span>                         filename_col <span class="op">=</span> <span class="st">"filename"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "FSC-A w= 0 t= 189548.3125"</span></span>
<span><span class="co">## [1] "SSC-A w= 0 t= 143017.28125"</span></span>
<span><span class="co">## [1] "CD38 w= 1.00467092903809 t= 21098.90234375"</span></span>
<span><span class="co">## [1] "CD8 w= 1.39087928377008 t= 13280.115234375"</span></span>
<span><span class="co">## [1] "CD195 (CCR5) w= 1.47496968547118 t= 9324.6044921875"</span></span>
<span><span class="co">## [1] "CD94 (KLRD1) w= 1.14024165714939 t= 52697.83984375"</span></span>
<span><span class="co">## [1] "CD45RA w= 0.575559538942434 t= 188189.21875"</span></span>
<span><span class="co">## [1] "HLA-DR w= 0.906457376716275 t= 52268.72265625"</span></span>
<span><span class="co">## [1] "CD56 w= 1.08251168835056 t= 38711.34375"</span></span>
<span><span class="co">## [1] "CD127 (IL7RA) w= 1.24594483351245 t= 22799.275390625"</span></span>
<span><span class="co">## [1] "CD14 w= 1.20856525032223 t= 19707.974609375"</span></span>
<span><span class="co">## [1] "CD64 w= 1.46255388991963 t= 30131.552734375"</span></span>
<span><span class="co">## [1] "CD4 w= 1.11074922553137 t= 60661.015625"</span></span>
<span><span class="co">## [1] "IgD w= 1.01328989695129 t= 86759.4296875"</span></span>
<span><span class="co">## [1] "CD19 w= 1.1442639974397 t= 56064.35546875"</span></span>
<span><span class="co">## [1] "CD16 w= 0.907155415750036 t= 183188.46875"</span></span>
<span><span class="co">## [1] "CD32 w= 1.14295376712075 t= 24696.62109375"</span></span>
<span><span class="co">## [1] "CD197 (CCR7) w= 1.06373634722298 t= 28634.5234375"</span></span>
<span><span class="co">## [1] "CD20 w= 1.07250534509397 t= 59596.2265625"</span></span>
<span><span class="co">## [1] "CD27 w= 1.31710110098513 t= 22037.9765625"</span></span>
<span><span class="co">## [1] "CD15 w= 1.29414575567539 t= 52487.171875"</span></span>
<span><span class="co">## [1] "PD-1 w= 1.91283109324646 t= 3218.92749023438"</span></span>
<span><span class="co">## [1] "CD3 w= 1.2093241717371 t= 36624.5625"</span></span>
<span><span class="co">## [1] "CD57 w= 0.36295690399458 t= 386989.96875"</span></span>
<span><span class="co">## [1] "CD25 w= 1.05414262118344 t= 16987.53515625"</span></span>
<span><span class="co">## [1] "CD123 (IL3RA) w= 1.12703027334259 t= 66552.2265625"</span></span>
<span><span class="co">## [1] "CD13 w= 1.06214617659589 t= 105455.2265625"</span></span>
<span><span class="co">## [1] "CD11c w= 0.961656743322294 t= 61599.1171875"</span></span></code></pre>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor_train</span><span class="op">$</span><span class="va">anno</span><span class="op">$</span><span class="va">cell_anno</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="st">"train"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="loading-the-data-for-projection">Loading the data for projection<a class="anchor" aria-label="anchor" href="#loading-the-data-for-projection"></a>
</h2>
<p>We also load the data to later project.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_fcd.html">prep_fcd</a></span><span class="op">(</span>data_path <span class="op">=</span> <span class="st">"../../../Figure 6 - Data Projection/data_and_envs/fcs_test/"</span>,</span>
<span>                        max_cell <span class="op">=</span> <span class="fl">10000</span>,</span>
<span>                        useCSV <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                        transformation <span class="op">=</span> <span class="st">"auto_logi"</span>,</span>
<span>                        remove_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FSC-H"</span>, <span class="st">"SSC-H"</span>, <span class="st">"FSC-W"</span>, <span class="st">"SSC-W"</span>, <span class="st">"Time"</span>, <span class="st">"live_dead"</span><span class="op">)</span>,</span>
<span>                        anno_table <span class="op">=</span> <span class="st">"../../../Figure 6 - Data Projection/data_and_envs/metadata_test.csv"</span>,</span>
<span>                        filename_col <span class="op">=</span> <span class="st">"filename"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "FSC-A w= 0 t= 185496.546875"</span></span>
<span><span class="co">## [1] "SSC-A w= 0 t= 139761.484375"</span></span>
<span><span class="co">## [1] "CD38 w= 1.08547016720781 t= 13277.1572265625"</span></span>
<span><span class="co">## [1] "CD8 w= 1.48560061602496 t= 7864.705078125"</span></span>
<span><span class="co">## [1] "CD195 (CCR5) w= 1.50085615737931 t= 8613.083984375"</span></span>
<span><span class="co">## [1] "CD94 (KLRD1) w= 1.21217921134578 t= 38320.88671875"</span></span>
<span><span class="co">## [1] "CD45RA w= 0.620511970611501 t= 173972.0625"</span></span>
<span><span class="co">## [1] "HLA-DR w= 1.09669597244259 t= 20941.41015625"</span></span>
<span><span class="co">## [1] "CD56 w= 1.06739206852295 t= 34215.83984375"</span></span>
<span><span class="co">## [1] "CD127 (IL7RA) w= 1.61853635269781 t= 3892.93969726562"</span></span>
<span><span class="co">## [1] "CD14 w= 1.26677471297522 t= 14700.3818359375"</span></span>
<span><span class="co">## [1] "CD64 w= 0.899618799383607 t= 339462.875"</span></span>
<span><span class="co">## [1] "CD4 w= 1.07758754326147 t= 67894.796875"</span></span>
<span><span class="co">## [1] "IgD w= 1.12861167597351 t= 48291.58203125"</span></span>
<span><span class="co">## [1] "CD19 w= 1.21481288924708 t= 43206.7890625"</span></span>
<span><span class="co">## [1] "CD16 w= 1.17429955588297 t= 64739.12109375"</span></span>
<span><span class="co">## [1] "CD32 w= 1.46577688239247 t= 5517.2109375"</span></span>
<span><span class="co">## [1] "CD197 (CCR7) w= 1.6248268378295 t= 2004.80041503906"</span></span>
<span><span class="co">## [1] "CD20 w= 1.2230402255227 t= 29262.005859375"</span></span>
<span><span class="co">## [1] "CD27 w= 1.24496607596317 t= 27285.08984375"</span></span>
<span><span class="co">## [1] "CD15 w= 1.43146259961623 t= 26227.884765625"</span></span>
<span><span class="co">## [1] "PD-1 w= 1.96432495215 t= 2769.64282226562"</span></span>
<span><span class="co">## [1] "CD3 w= 1.31097005291493 t= 27068.626953125"</span></span>
<span><span class="co">## [1] "CD57 w= 0.405977305077584 t= 316672.84375"</span></span>
<span><span class="co">## [1] "CD25 w= 1.06638241667567 t= 16345.5"</span></span>
<span><span class="co">## [1] "CD123 (IL3RA) w= 1.06963230873939 t= 65990.96875"</span></span>
<span><span class="co">## [1] "CD13 w= 1.21846591936931 t= 57385.46484375"</span></span>
<span><span class="co">## [1] "CD11c w= 1.04066753642893 t= 40379.015625"</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor_test</span><span class="op">$</span><span class="va">anno</span><span class="op">$</span><span class="va">cell_anno</span><span class="op">$</span><span class="va">group</span> <span class="op">&lt;-</span> <span class="st">"test"</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="umap-projection">UMAP Projection<a class="anchor" aria-label="anchor" href="#umap-projection"></a>
</h2>
<p>We start now by running a UMAP, in this case we set the
<code>ret_model</code> variable to <code>TRUE</code> to keep the UMAP
model in the <code>condor</code> object. The UMAP calculation and data
projection can be performed only based on the protein expression
(<code>expr</code>) as <code>pca</code> would be performed independently
in the two dataset not providing consistent results.</p>
<div class="section level3">
<h3 id="run-umap-keeping-the-model">Run UMAP keeping the model<a class="anchor" aria-label="anchor" href="#run-umap-keeping-the-model"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runUMAP.html">runUMAP</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor_train</span>, </span>
<span>                        input_type <span class="op">=</span> <span class="st">"expr"</span>, </span>
<span>                        data_slot <span class="op">=</span> <span class="st">"orig"</span>, </span>
<span>                        nThreads <span class="op">=</span> <span class="fl">4</span>,</span>
<span>                        ret_model <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="add-data-to-the-embedding">Add data to the embedding<a class="anchor" aria-label="anchor" href="#add-data-to-the-embedding"></a>
</h3>
<p>We can now predict the UMAP coordinates of the test data.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor_test</span><span class="op">&lt;-</span> <span class="fu"><a href="../reference/learnUMAP.html">learnUMAP</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor_test</span>,</span>
<span>                        input_type <span class="op">=</span> <span class="st">"expr"</span>, </span>
<span>                        data_slot <span class="op">=</span> <span class="st">"orig"</span>, </span>
<span>                        fcd_model <span class="op">=</span> <span class="va">condor_train</span>,</span>
<span>                        nEpochs <span class="op">=</span> <span class="fl">100</span>, </span>
<span>                        nThreads <span class="op">=</span> <span class="fl">4</span>, </span>
<span>                        prefix <span class="op">=</span> <span class="st">"pred"</span><span class="op">)</span></span></code></pre></div>
<p>The predicted UMAP coordinates can be accessed via
<code>condor_test$umap$pred_expr_orig</code>.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor_test</span><span class="op">$</span><span class="va">umap</span><span class="op">$</span><span class="va">pred_expr_orig</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##                UMAP1      UMAP2</span></span>
<span><span class="co">## ID10.fcs_1  8.721360   0.634307</span></span>
<span><span class="co">## ID10.fcs_2 -2.714980   9.288510</span></span>
<span><span class="co">## ID10.fcs_3 -5.952371  -3.586285</span></span>
<span><span class="co">## ID10.fcs_4 -3.397721 -11.507561</span></span>
<span><span class="co">## ID10.fcs_5 -3.282857  -3.098220</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="train-a-classifier-for-the-label-transfer">Train a classifier for the label transfer<a class="anchor" aria-label="anchor" href="#train-a-classifier-for-the-label-transfer"></a>
</h2>
<p>To transfer also the labels from the reference to the projected data
we need to train a cell classifier. We start by clustering the training
data. In this case both <code>FlowSOM</code> and
<code>Phenogpraph</code> can be used as input for the cell label kNN
classifier. In this vignette we use <code>Phenograph</code>.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/runPhenograph.html">runPhenograph</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor_train</span>, </span>
<span>                              input_type <span class="op">=</span> <span class="st">"expr"</span>, </span>
<span>                              data_slot <span class="op">=</span> <span class="st">"orig"</span>, </span>
<span>                              k <span class="op">=</span> <span class="fl">150</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Run Rphenograph starts:</span></span>
<span><span class="co">##   -Input data of 45000 rows and 28 columns</span></span>
<span><span class="co">##   -k is set to 150</span></span></code></pre>
<pre><code><span><span class="co">##   Finding nearest neighbors...DONE ~ 57.221 s</span></span>
<span><span class="co">##   Compute jaccard coefficient between nearest-neighbor sets...</span></span></code></pre>
<pre><code><span><span class="co">## Presorting knn...</span></span></code></pre>
<pre><code><span><span class="co">## presorting DONE ~ 2.427 s</span></span>
<span><span class="co">##   Start jaccard</span></span>
<span><span class="co">## DONE ~ 42.605 s</span></span>
<span><span class="co">##   Build undirected graph from the weighted links...DONE ~ 5.386 s</span></span>
<span><span class="co">##   Run louvain clustering on the graph ...DONE ~ 30.041 s</span></span></code></pre>
<pre><code><span><span class="co">## Run Rphenograph DONE, totally takes 135.253s.</span></span></code></pre>
<pre><code><span><span class="co">##   Return a community class</span></span>
<span><span class="co">##   -Modularity value: 0.846826 </span></span>
<span><span class="co">##   -Number of clusters: 17</span></span></code></pre>
<p>We can visualize the <code>Phenograph</code> clustering in a
UMAP.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_dim_red.html">plot_dim_red</a></span><span class="op">(</span>fcd<span class="op">=</span> <span class="va">condor_train</span>,  </span>
<span>             expr_slot <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>             reduction_method <span class="op">=</span> <span class="st">"umap"</span>, </span>
<span>             reduction_slot <span class="op">=</span> <span class="st">"expr_orig"</span>, </span>
<span>             cluster_slot <span class="op">=</span> <span class="st">"phenograph_expr_orig_k_150"</span>,</span>
<span>             param <span class="op">=</span> <span class="st">"Phenograph"</span>,</span>
<span>             title <span class="op">=</span> <span class="st">"Phenograph clustering of the training data set"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Data_Projection_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="label-transfer">Label transfer<a class="anchor" aria-label="anchor" href="#label-transfer"></a>
</h2>
<p>Now, we train the classifier on the clustering labels. If you
assigned a metacluster label, this can also be used to train the
classifier.</p>
<div class="section level3">
<h3 id="train-label-transfer-knn-classifier">Train label transfer kNN classifier<a class="anchor" aria-label="anchor" href="#train-label-transfer-knn-classifier"></a>
</h3>
<p>Here, we use the <code>Phenograph</code> clustering labels as an
example to train the classifier. In many cases you probably want to use
the metacluster labels of an annotated flow cytometry data set which had
been previously assigned using <code><a href="../reference/metaclustering.html">metaclustering()</a></code>.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor_train</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train_transfer_model.html">train_transfer_model</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor_train</span>, </span>
<span>                                     data_slot <span class="op">=</span> <span class="st">"orig"</span>, </span>
<span>                                     input_type <span class="op">=</span> <span class="st">"expr"</span>, </span>
<span>                                     cluster_slot <span class="op">=</span> <span class="st">"phenograph_expr_orig_k_150"</span>,</span>
<span>                                     cluster_var <span class="op">=</span> <span class="st">"Phenograph"</span>,</span>
<span>                                     method <span class="op">=</span> <span class="st">"knn"</span>, </span>
<span>                                     tuneLength <span class="op">=</span> <span class="fl">5</span>, </span>
<span>                                     trControl <span class="op">=</span> <span class="fu">caret</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/caret/man/trainControl.html" class="external-link">trainControl</a></span><span class="op">(</span>method <span class="op">=</span> <span class="st">"cv"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: ggplot2</span></span></code></pre>
<pre><code><span><span class="co">## Loading required package: lattice</span></span></code></pre>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'caret'</span></span></code></pre>
<pre><code><span><span class="co">## The following object is masked from 'package:cyCONDOR':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     confusionMatrix</span></span></code></pre>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor_train</span><span class="op">$</span><span class="va">extras</span><span class="op">$</span><span class="va">lt_model</span><span class="op">$</span><span class="va">performance_plot</span></span></code></pre></div>
<p><img src="Data_Projection_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#kNN importance</span></span>
<span><span class="va">condor_train</span><span class="op">$</span><span class="va">extras</span><span class="op">$</span><span class="va">lt_model</span><span class="op">$</span><span class="va">features_plot</span></span></code></pre></div>
<p><img src="Data_Projection_files/figure-html/unnamed-chunk-12-1.png" width="960"></p>
</div>
<div class="section level3">
<h3 id="predict-the-labels">Predict the labels<a class="anchor" aria-label="anchor" href="#predict-the-labels"></a>
</h3>
<p>Based on the trained classifier, we predict now the cluster labels
for the test data set.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_labels.html">predict_labels</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor_test</span>, </span>
<span>                              data_slot <span class="op">=</span> <span class="st">"orig"</span>, </span>
<span>                              input_type <span class="op">=</span> <span class="st">"expr"</span>, </span>
<span>                              fcd_model <span class="op">=</span> <span class="va">condor_train</span>, </span>
<span>                              label <span class="op">=</span> <span class="st">"label_pred"</span><span class="op">)</span></span></code></pre></div>
<p>The predicted labels are saved in
<code>condor_test$clustering$label_pred</code>.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor_test</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">label_pred</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##   Description predicted_label</span></span>
<span><span class="co">## 1   predicted               7</span></span>
<span><span class="co">## 2   predicted              11</span></span>
<span><span class="co">## 3   predicted               9</span></span>
<span><span class="co">## 4   predicted              12</span></span>
<span><span class="co">## 5   predicted               1</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="visualize-the-results">Visualize the results<a class="anchor" aria-label="anchor" href="#visualize-the-results"></a>
</h2>
<p>We provide here some costom code to overlap in a single plot the
results from the train and test <code>condor</code> object. Nevertheless
the independent results of each dataset can be vidualized with
<code>cyCONDOR</code> built-in functions.</p>
<div class="section level3">
<h3 id="prepare-the-dataframe">Prepare the dataframe<a class="anchor" aria-label="anchor" href="#prepare-the-dataframe"></a>
</h3>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">train</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">condor_train</span><span class="op">$</span><span class="va">umap</span><span class="op">$</span><span class="va">expr_orig</span>, Phenograph <span class="op">=</span> <span class="va">condor_train</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">phenograph_expr_orig_k_150</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">train</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"train"</span></span>
<span></span>
<span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">condor_test</span><span class="op">$</span><span class="va">umap</span><span class="op">$</span><span class="va">pred_expr_orig</span>, </span>
<span>              <span class="va">condor_test</span><span class="op">$</span><span class="va">clustering</span><span class="op">$</span><span class="va">label_pred</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test</span><span class="op">$</span><span class="va">Description</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span><span class="va">test</span><span class="op">$</span><span class="va">Description</span> <span class="op">&lt;-</span> <span class="cn">NULL</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"UMAP1"</span>, <span class="st">"UMAP2"</span>, <span class="st">"Phenograph"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">test</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="st">"test"</span></span>
<span></span>
<span><span class="va">vis_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">train</span>, <span class="va">test</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="overlap-umap">Overlap UMAP<a class="anchor" aria-label="anchor" href="#overlap-umap"></a>
</h2>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">vis_data</span><span class="op">$</span><span class="va">type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">vis_data</span><span class="op">$</span><span class="va">type</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"train"</span>, <span class="st">"test"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">vis_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">UMAP1</span>, y <span class="op">=</span> <span class="va">UMAP2</span>, color <span class="op">=</span> <span class="va">type</span>, alpha <span class="op">=</span> <span class="va">type</span>, size <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"gray"</span>, <span class="st">"#92278F"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_alpha_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_size_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span>, panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"UMAP projected"</span><span class="op">)</span></span></code></pre></div>
<p><img src="Data_Projection_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">vis_data</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">UMAP1</span>, y <span class="op">=</span> <span class="va">UMAP2</span>, color <span class="op">=</span> <span class="va">Phenograph</span>, alpha <span class="op">=</span> <span class="va">type</span>, size <span class="op">=</span> <span class="va">type</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_alpha_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_size_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span>, panel.grid <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"Predicted cluster"</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">type</span><span class="op">)</span></span></code></pre></div>
<p><img src="Data_Projection_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">info</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Etc/UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] caret_6.0-94   lattice_0.22-5 ggplot2_3.4.4  cyCONDOR_0.1.6</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] IRanges_2.34.1              Rmisc_1.5.1                </span></span>
<span><span class="co">##   [3] urlchecker_1.0.1            nnet_7.3-19                </span></span>
<span><span class="co">##   [5] CytoNorm_2.0.1              TH.data_1.1-2              </span></span>
<span><span class="co">##   [7] vctrs_0.6.4                 digest_0.6.33              </span></span>
<span><span class="co">##   [9] png_0.1-8                   shape_1.4.6                </span></span>
<span><span class="co">##  [11] proxy_0.4-27                slingshot_2.8.0            </span></span>
<span><span class="co">##  [13] ggrepel_0.9.4               parallelly_1.36.0          </span></span>
<span><span class="co">##  [15] MASS_7.3-60                 pkgdown_2.0.7              </span></span>
<span><span class="co">##  [17] reshape2_1.4.4              httpuv_1.6.12              </span></span>
<span><span class="co">##  [19] foreach_1.5.2               BiocGenerics_0.46.0        </span></span>
<span><span class="co">##  [21] withr_2.5.1                 ggrastr_1.0.2              </span></span>
<span><span class="co">##  [23] xfun_0.40                   ggpubr_0.6.0               </span></span>
<span><span class="co">##  [25] ellipsis_0.3.2              survival_3.5-7             </span></span>
<span><span class="co">##  [27] memoise_2.0.1               hexbin_1.28.3              </span></span>
<span><span class="co">##  [29] ggbeeswarm_0.7.2            RProtoBufLib_2.12.1        </span></span>
<span><span class="co">##  [31] princurve_2.1.6             profvis_0.3.8              </span></span>
<span><span class="co">##  [33] ggsci_3.0.0                 systemfonts_1.0.5          </span></span>
<span><span class="co">##  [35] ragg_1.2.6                  zoo_1.8-12                 </span></span>
<span><span class="co">##  [37] GlobalOptions_0.1.2         DEoptimR_1.1-3             </span></span>
<span><span class="co">##  [39] Formula_1.2-5               prettyunits_1.2.0          </span></span>
<span><span class="co">##  [41] promises_1.2.1              scatterplot3d_0.3-44       </span></span>
<span><span class="co">##  [43] rstatix_0.7.2               globals_0.16.2             </span></span>
<span><span class="co">##  [45] ps_1.7.5                    rstudioapi_0.15.0          </span></span>
<span><span class="co">##  [47] miniUI_0.1.1.1              generics_0.1.3             </span></span>
<span><span class="co">##  [49] ggcyto_1.28.1               base64enc_0.1-3            </span></span>
<span><span class="co">##  [51] processx_3.8.2              curl_5.1.0                 </span></span>
<span><span class="co">##  [53] S4Vectors_0.38.2            zlibbioc_1.46.0            </span></span>
<span><span class="co">##  [55] flowWorkspace_4.12.2        polyclip_1.10-6            </span></span>
<span><span class="co">##  [57] randomForest_4.7-1.1        GenomeInfoDbData_1.2.10    </span></span>
<span><span class="co">##  [59] RBGL_1.76.0                 ncdfFlow_2.46.0            </span></span>
<span><span class="co">##  [61] RcppEigen_0.3.3.9.4         xtable_1.8-4               </span></span>
<span><span class="co">##  [63] stringr_1.5.0               desc_1.4.2                 </span></span>
<span><span class="co">##  [65] doParallel_1.0.17           evaluate_0.22              </span></span>
<span><span class="co">##  [67] S4Arrays_1.0.6              hms_1.1.3                  </span></span>
<span><span class="co">##  [69] glmnet_4.1-8                GenomicRanges_1.52.1       </span></span>
<span><span class="co">##  [71] irlba_2.3.5.1               colorspace_2.1-0           </span></span>
<span><span class="co">##  [73] harmony_1.1.0               reticulate_1.34.0          </span></span>
<span><span class="co">##  [75] readxl_1.4.3                magrittr_2.0.3             </span></span>
<span><span class="co">##  [77] lmtest_0.9-40               readr_2.1.4                </span></span>
<span><span class="co">##  [79] Rgraphviz_2.44.0            later_1.3.1                </span></span>
<span><span class="co">##  [81] future.apply_1.11.0         robustbase_0.99-0          </span></span>
<span><span class="co">##  [83] XML_3.99-0.15               cowplot_1.1.1              </span></span>
<span><span class="co">##  [85] matrixStats_1.1.0           RcppAnnoy_0.0.21           </span></span>
<span><span class="co">##  [87] xts_0.13.1                  class_7.3-22               </span></span>
<span><span class="co">##  [89] Hmisc_5.1-1                 pillar_1.9.0               </span></span>
<span><span class="co">##  [91] nlme_3.1-163                iterators_1.0.14           </span></span>
<span><span class="co">##  [93] compiler_4.3.1              RSpectra_0.16-1            </span></span>
<span><span class="co">##  [95] stringi_1.7.12              gower_1.0.1                </span></span>
<span><span class="co">##  [97] minqa_1.2.6                 SummarizedExperiment_1.30.2</span></span>
<span><span class="co">##  [99] lubridate_1.9.3             devtools_2.4.5             </span></span>
<span><span class="co">## [101] CytoML_2.12.0               plyr_1.8.9                 </span></span>
<span><span class="co">## [103] crayon_1.5.2                abind_1.4-5                </span></span>
<span><span class="co">## [105] locfit_1.5-9.8              sp_2.1-1                   </span></span>
<span><span class="co">## [107] sandwich_3.0-2              pcaMethods_1.92.0          </span></span>
<span><span class="co">## [109] dplyr_1.1.3                 codetools_0.2-19           </span></span>
<span><span class="co">## [111] multcomp_1.4-25             textshaping_0.3.7          </span></span>
<span><span class="co">## [113] recipes_1.0.8               openssl_2.1.1              </span></span>
<span><span class="co">## [115] Rphenograph_0.99.1          TTR_0.24.3                 </span></span>
<span><span class="co">## [117] bslib_0.5.1                 e1071_1.7-13               </span></span>
<span><span class="co">## [119] destiny_3.14.0              GetoptLong_1.0.5           </span></span>
<span><span class="co">## [121] ggplot.multistats_1.0.0     mime_0.12                  </span></span>
<span><span class="co">## [123] splines_4.3.1               circlize_0.4.15            </span></span>
<span><span class="co">## [125] Rcpp_1.0.11                 sparseMatrixStats_1.12.2   </span></span>
<span><span class="co">## [127] cellranger_1.1.0            knitr_1.44                 </span></span>
<span><span class="co">## [129] utf8_1.2.4                  clue_0.3-65                </span></span>
<span><span class="co">## [131] lme4_1.1-35.1               fs_1.6.3                   </span></span>
<span><span class="co">## [133] listenv_0.9.0               checkmate_2.3.0            </span></span>
<span><span class="co">## [135] DelayedMatrixStats_1.22.6   pkgbuild_1.4.2             </span></span>
<span><span class="co">## [137] ggsignif_0.6.4              tibble_3.2.1               </span></span>
<span><span class="co">## [139] Matrix_1.6-1.1              rpart.plot_3.1.1           </span></span>
<span><span class="co">## [141] callr_3.7.3                 tzdb_0.4.0                 </span></span>
<span><span class="co">## [143] tweenr_2.0.2                pkgconfig_2.0.3            </span></span>
<span><span class="co">## [145] pheatmap_1.0.12             tools_4.3.1                </span></span>
<span><span class="co">## [147] cachem_1.0.8                smoother_1.1               </span></span>
<span><span class="co">## [149] fastmap_1.1.1               rmarkdown_2.25             </span></span>
<span><span class="co">## [151] scales_1.2.1                grid_4.3.1                 </span></span>
<span><span class="co">## [153] usethis_2.2.2               broom_1.0.5                </span></span>
<span><span class="co">## [155] sass_0.4.7                  graph_1.78.0               </span></span>
<span><span class="co">## [157] carData_3.0-5               RANN_2.6.1                 </span></span>
<span><span class="co">## [159] rpart_4.1.21                farver_2.1.1               </span></span>
<span><span class="co">## [161] yaml_2.3.7                  MatrixGenerics_1.12.3      </span></span>
<span><span class="co">## [163] foreign_0.8-85              ggthemes_4.2.4             </span></span>
<span><span class="co">## [165] cli_3.6.1                   purrr_1.0.2                </span></span>
<span><span class="co">## [167] stats4_4.3.1                lifecycle_1.0.3            </span></span>
<span><span class="co">## [169] uwot_0.1.16                 askpass_1.2.0              </span></span>
<span><span class="co">## [171] Biobase_2.60.0              mvtnorm_1.2-3              </span></span>
<span><span class="co">## [173] lava_1.7.3                  sessioninfo_1.2.2          </span></span>
<span><span class="co">## [175] backports_1.4.1             cytolib_2.12.1             </span></span>
<span><span class="co">## [177] timechange_0.2.0            gtable_0.3.4               </span></span>
<span><span class="co">## [179] rjson_0.2.21                umap_0.2.10.0              </span></span>
<span><span class="co">## [181] ggridges_0.5.4              Rphenoannoy_0.1.0          </span></span>
<span><span class="co">## [183] parallel_4.3.1              pROC_1.18.5                </span></span>
<span><span class="co">## [185] limma_3.56.2                jsonlite_1.8.7             </span></span>
<span><span class="co">## [187] edgeR_3.42.4                RcppHNSW_0.5.0             </span></span>
<span><span class="co">## [189] bitops_1.0-7                Rtsne_0.16                 </span></span>
<span><span class="co">## [191] FlowSOM_2.8.0               ranger_0.16.0              </span></span>
<span><span class="co">## [193] flowCore_2.12.2             jquerylib_0.1.4            </span></span>
<span><span class="co">## [195] timeDate_4022.108           shiny_1.7.5.1              </span></span>
<span><span class="co">## [197] ConsensusClusterPlus_1.64.0 htmltools_0.5.6.1          </span></span>
<span><span class="co">## [199] diffcyt_1.20.0              glue_1.6.2                 </span></span>
<span><span class="co">## [201] XVector_0.40.0              VIM_6.2.2                  </span></span>
<span><span class="co">## [203] RCurl_1.98-1.13             rprojroot_2.0.3            </span></span>
<span><span class="co">## [205] gridExtra_2.3               boot_1.3-28.1              </span></span>
<span><span class="co">## [207] TrajectoryUtils_1.8.0       igraph_1.5.1               </span></span>
<span><span class="co">## [209] R6_2.5.1                    tidyr_1.3.0                </span></span>
<span><span class="co">## [211] SingleCellExperiment_1.22.0 labeling_0.4.3             </span></span>
<span><span class="co">## [213] vcd_1.4-11                  cluster_2.1.4              </span></span>
<span><span class="co">## [215] pkgload_1.3.3               GenomeInfoDb_1.36.4        </span></span>
<span><span class="co">## [217] ipred_0.9-14                nloptr_2.0.3               </span></span>
<span><span class="co">## [219] DelayedArray_0.26.7         tidyselect_1.2.0           </span></span>
<span><span class="co">## [221] vipor_0.4.5                 htmlTable_2.4.2            </span></span>
<span><span class="co">## [223] ggforce_0.4.1               CytoDx_1.20.0              </span></span>
<span><span class="co">## [225] car_3.1-2                   future_1.33.0              </span></span>
<span><span class="co">## [227] ModelMetrics_1.2.2.2        munsell_0.5.0              </span></span>
<span><span class="co">## [229] laeken_0.5.2                data.table_1.14.8          </span></span>
<span><span class="co">## [231] htmlwidgets_1.6.2           ComplexHeatmap_2.16.0      </span></span>
<span><span class="co">## [233] RColorBrewer_1.1-3          rlang_1.1.1                </span></span>
<span><span class="co">## [235] remotes_2.4.2.1             colorRamps_2.3.1           </span></span>
<span><span class="co">## [237] ggnewscale_0.4.9            fansi_1.0.5                </span></span>
<span><span class="co">## [239] hardhat_1.3.0               beeswarm_0.4.0             </span></span>
<span><span class="co">## [241] prodlim_2023.08.28</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Lorenzo Bonaguro, Charlotte Kroeger, Sophie Mueller, Jacqueline Leidner.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
