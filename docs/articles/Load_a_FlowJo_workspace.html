<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="cyCONDOR">
<title>Load a FlowJo workspace • cyCONDOR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Load a FlowJo workspace">
<meta property="og:description" content="cyCONDOR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">cyCONDOR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/cyCONDOR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Prepare_data_for_cyCONDOR_analysis.html">Prepare data for cyCONDOR analysis</a>
    <a class="dropdown-item" href="../articles/How_to_run_cyCONDOR_as_container.html">How to run cyCONDOR as container</a>
    <a class="dropdown-item" href="../articles/Data_Loading_and_Transformation.html">Data Loading and Transformation</a>
    <a class="dropdown-item" href="../articles/Load_a_FlowJo_workspace.html">Load a FlowJo workspace</a>
    <a class="dropdown-item" href="../articles/Dimensionality_Reduction.html">Dimensionality Reduction</a>
    <a class="dropdown-item" href="../articles/Clustering_and_cell_annotation.html">Clustering and cell annotation</a>
    <a class="dropdown-item" href="../articles/Batch_correction.html">Batch correction</a>
    <a class="dropdown-item" href="../articles/Data_Visualization.html">Data Visualization</a>
    <a class="dropdown-item" href="../articles/Differential_Analysis.html">Differential Analysis with cyCONDOR</a>
    <a class="dropdown-item" href="../articles/Pseudotime_analysis.html">Pseudotime analysis</a>
    <a class="dropdown-item" href="../articles/Data_Projection.html">Data Projection</a>
    <a class="dropdown-item" href="../articles/Machine_learning_classifier.html">Machine learning classifier</a>
    <a class="dropdown-item" href="../articles/Cell_type_prediction.html">Cell type prediction</a>
    <a class="dropdown-item" href="../articles/Other_utilities.html">Introduction to the condor object and other utilities</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lorenzobonaguro/condor/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Load a FlowJo workspace</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lorenzobonaguro/condor/blob/HEAD/vignettes/Load_a_FlowJo_workspace.Rmd" class="external-link"><code>vignettes/Load_a_FlowJo_workspace.Rmd</code></a></small>
      <div class="d-none name"><code>Load_a_FlowJo_workspace.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lorenzobonaguro/condor" class="external-link">cyCONDOR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">flowWorkspace</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RGLab/CytoML" class="external-link">CytoML</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/Biobase" class="external-link">Biobase</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<p>Within the <code>cyCONDOR</code> ecosystem it is possible to load a
FlowJo work space (.wsp file). This gives the advantage of having the
gating hierarchy in the <code>fcd</code> object. We would still
reccomend using files preprocessed as described in
vignette(“Prepare_data_for_cyCONDOR_analysis”) to be fully compatible
with all downstream analysis (e.g. cytonorm). Exported compensared files
can be loaded in FlowJo and used for gating analysis.</p>
<div class="section level3">
<h3 id="read-the--wsp-file">Read the .wsp file<a class="anchor" aria-label="anchor" href="#read-the--wsp-file"></a>
</h3>
<p>First we use the <a href="https://doi.org/10.18129/B9.bioc.CytoML" class="external-link">CytoML</a> package to
load the <code>.wsp</code> file.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ws</span> <span class="op">&lt;-</span> <span class="fu">CytoML</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/CytoML/man/open_flowjo_xml.html" class="external-link">open_flowjo_xml</a></span><span class="op">(</span><span class="st">"../.test_files/flowjo_workspace.wsp"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">ws</span></span></code></pre></div>
<pre><code><span><span class="co">## File location:  ../.test_files/flowjo_workspace.wsp </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Groups in Workspace</span></span>
<span><span class="co">##          Name Num.Samples</span></span>
<span><span class="co">## 1 All Samples           3</span></span>
<span><span class="co">## 2     samples           3</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="transformation-into-gatingset-object">Transformation into <strong>GatingSet</strong> object<a class="anchor" aria-label="anchor" href="#transformation-into-gatingset-object"></a>
</h3>
<p>We then transform the object to a <code>GatingSet</code> object.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gs</span> <span class="op">&lt;-</span> <span class="fu">CytoML</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/CytoML/man/flowjo_to_gatingset.html" class="external-link">flowjo_to_gatingset</a></span><span class="op">(</span><span class="va">ws</span>, name <span class="op">=</span> <span class="st">"samples"</span>, path <span class="op">=</span> <span class="st">"../.test_files/fcs_flowjo_ws/"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">gs</span></span></code></pre></div>
<pre><code><span><span class="co">## A GatingSet with 3 samples</span></span></code></pre>
<div class="section level4">
<h4 id="visualization-of-the-flowjo-gating-strategy">Visualization of the FlowJo gating strategy<a class="anchor" aria-label="anchor" href="#visualization-of-the-flowjo-gating-strategy"></a>
</h4>
<p>We visualize the gating hierarchy and look at the cell count per
gated population.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">flowWorkspace</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/base/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">gs</span>, bool <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="Load_a_FlowJo_workspace_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">flowWorkspace</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/flowWorkspace/man/gs_pop_get_stats.html" class="external-link">gs_pop_get_stats</a></span><span class="op">(</span><span class="va">gs</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                            sample</span></span>
<span><span class="co">##  1: Experiment_AID_01.fcs_1760146</span></span>
<span><span class="co">##  2: Experiment_AID_01.fcs_1760146</span></span>
<span><span class="co">##  3: Experiment_AID_01.fcs_1760146</span></span>
<span><span class="co">##  4: Experiment_AID_01.fcs_1760146</span></span>
<span><span class="co">##  5: Experiment_AID_01.fcs_1760146</span></span>
<span><span class="co">##  6: Experiment_AID_01.fcs_1760146</span></span>
<span><span class="co">##  7: Experiment_AID_01.fcs_1760146</span></span>
<span><span class="co">##  8: Experiment_AID_01.fcs_1760146</span></span>
<span><span class="co">##  9: Experiment_AID_01.fcs_1760146</span></span>
<span><span class="co">## 10: Experiment_AID_02.fcs_3828740</span></span>
<span><span class="co">## 11: Experiment_AID_02.fcs_3828740</span></span>
<span><span class="co">## 12: Experiment_AID_02.fcs_3828740</span></span>
<span><span class="co">## 13: Experiment_AID_02.fcs_3828740</span></span>
<span><span class="co">## 14: Experiment_AID_02.fcs_3828740</span></span>
<span><span class="co">## 15: Experiment_AID_02.fcs_3828740</span></span>
<span><span class="co">## 16: Experiment_AID_02.fcs_3828740</span></span>
<span><span class="co">## 17: Experiment_AID_02.fcs_3828740</span></span>
<span><span class="co">## 18: Experiment_AID_02.fcs_3828740</span></span>
<span><span class="co">## 19: Experiment_AID_03.fcs_4122432</span></span>
<span><span class="co">## 20: Experiment_AID_03.fcs_4122432</span></span>
<span><span class="co">## 21: Experiment_AID_03.fcs_4122432</span></span>
<span><span class="co">## 22: Experiment_AID_03.fcs_4122432</span></span>
<span><span class="co">## 23: Experiment_AID_03.fcs_4122432</span></span>
<span><span class="co">## 24: Experiment_AID_03.fcs_4122432</span></span>
<span><span class="co">## 25: Experiment_AID_03.fcs_4122432</span></span>
<span><span class="co">## 26: Experiment_AID_03.fcs_4122432</span></span>
<span><span class="co">## 27: Experiment_AID_03.fcs_4122432</span></span>
<span><span class="co">##                            sample</span></span>
<span><span class="co">##                                                              pop   count</span></span>
<span><span class="co">##  1:                                                         root 1760146</span></span>
<span><span class="co">##  2:                                                 /Lymphocytes  259769</span></span>
<span><span class="co">##  3:                                    /Lymphocytes/Single Cells  259132</span></span>
<span><span class="co">##  4:                       /Lymphocytes/Single Cells/Single Cells  256701</span></span>
<span><span class="co">##  5:                 /Lymphocytes/Single Cells/Single Cells/CD45+  243416</span></span>
<span><span class="co">##  6:            /Lymphocytes/Single Cells/Single Cells/CD45+/CD3+   98595</span></span>
<span><span class="co">##  7:           /Lymphocytes/Single Cells/Single Cells/CD45+/CD19+    6109</span></span>
<span><span class="co">##  8:          /Lymphocytes/Single Cells/Single Cells/CD45+/others  138248</span></span>
<span><span class="co">##  9: /Lymphocytes/Single Cells/Single Cells/CD45+/others/NK cells   15653</span></span>
<span><span class="co">## 10:                                                         root 3828740</span></span>
<span><span class="co">## 11:                                                 /Lymphocytes  502723</span></span>
<span><span class="co">## 12:                                    /Lymphocytes/Single Cells  501266</span></span>
<span><span class="co">## 13:                       /Lymphocytes/Single Cells/Single Cells  500119</span></span>
<span><span class="co">## 14:                 /Lymphocytes/Single Cells/Single Cells/CD45+  478517</span></span>
<span><span class="co">## 15:            /Lymphocytes/Single Cells/Single Cells/CD45+/CD3+  129406</span></span>
<span><span class="co">## 16:           /Lymphocytes/Single Cells/Single Cells/CD45+/CD19+   15063</span></span>
<span><span class="co">## 17:          /Lymphocytes/Single Cells/Single Cells/CD45+/others  333430</span></span>
<span><span class="co">## 18: /Lymphocytes/Single Cells/Single Cells/CD45+/others/NK cells   14716</span></span>
<span><span class="co">## 19:                                                         root 4122432</span></span>
<span><span class="co">## 20:                                                 /Lymphocytes 1453126</span></span>
<span><span class="co">## 21:                                    /Lymphocytes/Single Cells 1450633</span></span>
<span><span class="co">## 22:                       /Lymphocytes/Single Cells/Single Cells 1440203</span></span>
<span><span class="co">## 23:                 /Lymphocytes/Single Cells/Single Cells/CD45+ 1391893</span></span>
<span><span class="co">## 24:            /Lymphocytes/Single Cells/Single Cells/CD45+/CD3+   92151</span></span>
<span><span class="co">## 25:           /Lymphocytes/Single Cells/Single Cells/CD45+/CD19+   12424</span></span>
<span><span class="co">## 26:          /Lymphocytes/Single Cells/Single Cells/CD45+/others 1286628</span></span>
<span><span class="co">## 27: /Lymphocytes/Single Cells/Single Cells/CD45+/others/NK cells   22297</span></span>
<span><span class="co">##                                                              pop   count</span></span></code></pre>
</div>
</div>
<div class="section level3">
<h3 id="prepare-the-data-for-cycondor">Prepare the data for <strong>cyCONDOR</strong><a class="anchor" aria-label="anchor" href="#prepare-the-data-for-cycondor"></a>
</h3>
<p>From the <code>GatingSet</code> object we prepare the
<code>fcd</code> object using <code><a href="../reference/prep_fjw.html">prep_fjw()</a></code>. Here, we provide
the <code>GatingSet</code> object as input, reverse the FlowJo
tranformation, perform an autologicle transformation and remove the
parameter “Time”. Optionally, we can read in an annotation table to add
further sample information (not shown).</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_fjw.html">prep_fjw</a></span><span class="op">(</span>data_gs <span class="op">=</span> <span class="va">gs</span>, </span>
<span>                   inverse.transform <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                   transformation <span class="op">=</span> <span class="st">"auto_logi"</span>,</span>
<span>                   remove_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span><span class="op">)</span></span>
<span>                   <span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "FSC-A w= 0 t= 262143"</span></span>
<span><span class="co">## [1] "FSC-H w= 0 t= 166547"</span></span>
<span><span class="co">## [1] "FSC-W w= 0 t= 262143"</span></span>
<span><span class="co">## [1] "SSC-A w= 0.892977713264162 t= 262143"</span></span>
<span><span class="co">## [1] "SSC-H w= 0 t= 257403"</span></span>
<span><span class="co">## [1] "SSC-W w= 0 t= 262143"</span></span>
<span><span class="co">## [1] "CD45 w= 0.400130442523775 t= 261330.171875"</span></span>
<span><span class="co">## [1] "CD4 w= 0.583624943577614 t= 262054.046875"</span></span>
<span><span class="co">## [1] "CD16 w= 0.583304445730326 t= 262063.21875"</span></span>
<span><span class="co">## [1] "HLA-DR w= 0.526407100734133 t= 256403.078125"</span></span>
<span><span class="co">## [1] "CD66b w= 0.269925173514296 t= 262130.15625"</span></span>
<span><span class="co">## [1] "CD14 w= 0.520686238954203 t= 269475.84375"</span></span>
<span><span class="co">## [1] "CD56 w= 0.309385967148849 t= 266870.46875"</span></span>
<span><span class="co">## [1] "CD3 w= 0.777696607391664 t= 250297.484375"</span></span>
<span><span class="co">## [1] "CD11c w= 0.537743667858708 t= 203113.46875"</span></span>
<span><span class="co">## [1] "Siglec8 w= 0.323207654372646 t= 255847.03125"</span></span>
<span><span class="co">## [1] "CD8 w= 0.654399836071111 t= 254885.03125"</span></span>
<span><span class="co">## [1] "CD19 w= 0.343330229474141 t= 255034.515625"</span></span></code></pre>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">condor</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "flow_cytometry_dataframe"</span></span></code></pre>
<p>The performed FlowJo gating with the assigned cell populations is
saved in <code>condor$anno$cell_anno</code>.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor</span><span class="op">$</span><span class="va">anno</span><span class="op">$</span><span class="va">cell_anno</span><span class="op">[</span><span class="fl">110</span><span class="op">:</span><span class="fl">115</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##                                 expfcs_filename root Lymphocytes</span></span>
<span><span class="co">## Experiment_AID_01.fcs_110 Experiment_AID_01.fcs    1           0</span></span>
<span><span class="co">## Experiment_AID_01.fcs_111 Experiment_AID_01.fcs    1           0</span></span>
<span><span class="co">## Experiment_AID_01.fcs_112 Experiment_AID_01.fcs    1           0</span></span>
<span><span class="co">## Experiment_AID_01.fcs_113 Experiment_AID_01.fcs    1           1</span></span>
<span><span class="co">## Experiment_AID_01.fcs_114 Experiment_AID_01.fcs    1           0</span></span>
<span><span class="co">## Experiment_AID_01.fcs_115 Experiment_AID_01.fcs    1           1</span></span>
<span><span class="co">##                           Lymphocytes/Single Cells Single Cells/Single Cells</span></span>
<span><span class="co">## Experiment_AID_01.fcs_110                        0                         0</span></span>
<span><span class="co">## Experiment_AID_01.fcs_111                        0                         0</span></span>
<span><span class="co">## Experiment_AID_01.fcs_112                        0                         0</span></span>
<span><span class="co">## Experiment_AID_01.fcs_113                        1                         1</span></span>
<span><span class="co">## Experiment_AID_01.fcs_114                        0                         0</span></span>
<span><span class="co">## Experiment_AID_01.fcs_115                        1                         1</span></span>
<span><span class="co">##                           CD45+ CD3+ CD19+ others NK cells</span></span>
<span><span class="co">## Experiment_AID_01.fcs_110     0    0     0      0        0</span></span>
<span><span class="co">## Experiment_AID_01.fcs_111     0    0     0      0        0</span></span>
<span><span class="co">## Experiment_AID_01.fcs_112     0    0     0      0        0</span></span>
<span><span class="co">## Experiment_AID_01.fcs_113     1    1     0      0        0</span></span>
<span><span class="co">## Experiment_AID_01.fcs_114     0    0     0      0        0</span></span>
<span><span class="co">## Experiment_AID_01.fcs_115     1    0     0      1        0</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="filter-for-a-population">Filter for a population<a class="anchor" aria-label="anchor" href="#filter-for-a-population"></a>
</h3>
<p>We can filter our data set for a population of interest e.g. the
CD45+ cells.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#select cell IDs of all CD45+ cells</span></span>
<span><span class="va">keep</span> <span class="op">&lt;-</span> <span class="va">condor</span><span class="op">$</span><span class="va">anno</span><span class="op">$</span><span class="va">cell_anno</span><span class="op">[</span><span class="va">condor</span><span class="op">$</span><span class="va">anno</span><span class="op">$</span><span class="va">cell_anno</span><span class="op">$</span><span class="va">`CD45+`</span> <span class="op">==</span> <span class="fl">1</span>,<span class="op">]</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html" class="external-link">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/row_colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#check the number of CD45+ cells</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">keep</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 2113826</span></span></code></pre>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#filter data for CD45+ cells</span></span>
<span><span class="va">condor_CD45</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/filter_fcd.html">filter_fcd</a></span><span class="op">(</span><span class="va">condor</span>, cell_ids <span class="op">=</span> <span class="va">keep</span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="simple-visualization-of-the-dataset-with-flowjo-gating">Simple visualization of the dataset with FlowJo gating<a class="anchor" aria-label="anchor" href="#simple-visualization-of-the-dataset-with-flowjo-gating"></a>
</h4>
<p>We can visualize the gated cell populations for example in a simple
dot plot. In the plot below, we plot the fluorescence intensity of CD3
against CD19 and color the cells by the ‘CD3+’ population from the
FlowJo workspace.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># subset condor to 10000 cells for visualization</span></span>
<span><span class="va">condor_sub</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/subset_fcd.html">subset_fcd</a></span><span class="op">(</span><span class="va">condor_CD45</span>, size<span class="op">=</span> <span class="fl">10000</span><span class="op">)</span></span>
<span></span>
<span><span class="co">#prepare data frame for plotting</span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocGenerics/man/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">condor_sub</span><span class="op">$</span><span class="va">expr</span><span class="op">$</span><span class="va">orig</span>, <span class="va">condor_sub</span><span class="op">$</span><span class="va">anno</span><span class="op">$</span><span class="va">cell_anno</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x<span class="op">=</span> <span class="va">`CD19`</span>, y <span class="op">=</span> <span class="va">`CD3`</span>, color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">as.factor</a></span><span class="op">(</span><span class="va">`CD3+`</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_viridis.html" class="external-link">scale_color_viridis_d</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="Load_a_FlowJo_workspace_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
<p>We can now continue with the usual <code>cyCONDOR</code> workflow
(see e.g. <code><a href="../articles/Dimensionality_Reduction.html">vignette("Dimensionality_Reduction")</a></code>,
<code><a href="../articles/Clustering_and_cell_annotation.html">vignette("Clustering_and_cell_annotation")</a></code> and
<code><a href="../articles/Data_Visualization.html">vignette("Data_Visualization")</a></code>.</p>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">info</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Etc/UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] dplyr_1.1.3          ggplot2_3.4.4        Biobase_2.60.0      </span></span>
<span><span class="co">## [4] BiocGenerics_0.46.0  CytoML_2.12.0        flowWorkspace_4.12.2</span></span>
<span><span class="co">## [7] cyCONDOR_0.1.6      </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] IRanges_2.34.1              Rmisc_1.5.1                </span></span>
<span><span class="co">##   [3] urlchecker_1.0.1            nnet_7.3-19                </span></span>
<span><span class="co">##   [5] CytoNorm_2.0.1              TH.data_1.1-2              </span></span>
<span><span class="co">##   [7] vctrs_0.6.4                 digest_0.6.33              </span></span>
<span><span class="co">##   [9] png_0.1-8                   shape_1.4.6                </span></span>
<span><span class="co">##  [11] proxy_0.4-27                slingshot_2.8.0            </span></span>
<span><span class="co">##  [13] ggrepel_0.9.4               parallelly_1.36.0          </span></span>
<span><span class="co">##  [15] MASS_7.3-60                 pkgdown_2.0.7              </span></span>
<span><span class="co">##  [17] reshape2_1.4.4              httpuv_1.6.12              </span></span>
<span><span class="co">##  [19] foreach_1.5.2               withr_2.5.1                </span></span>
<span><span class="co">##  [21] ggrastr_1.0.2               xfun_0.40                  </span></span>
<span><span class="co">##  [23] ggpubr_0.6.0                ellipsis_0.3.2             </span></span>
<span><span class="co">##  [25] survival_3.5-7              memoise_2.0.1              </span></span>
<span><span class="co">##  [27] hexbin_1.28.3               ggbeeswarm_0.7.2           </span></span>
<span><span class="co">##  [29] RProtoBufLib_2.12.1         princurve_2.1.6            </span></span>
<span><span class="co">##  [31] profvis_0.3.8               ggsci_3.0.0                </span></span>
<span><span class="co">##  [33] systemfonts_1.0.5           ragg_1.2.6                 </span></span>
<span><span class="co">##  [35] zoo_1.8-12                  GlobalOptions_0.1.2        </span></span>
<span><span class="co">##  [37] DEoptimR_1.1-3              Formula_1.2-5              </span></span>
<span><span class="co">##  [39] prettyunits_1.2.0           promises_1.2.1             </span></span>
<span><span class="co">##  [41] scatterplot3d_0.3-44        rstatix_0.7.2              </span></span>
<span><span class="co">##  [43] globals_0.16.2              ps_1.7.5                   </span></span>
<span><span class="co">##  [45] rstudioapi_0.15.0           miniUI_0.1.1.1             </span></span>
<span><span class="co">##  [47] generics_0.1.3              ggcyto_1.28.1              </span></span>
<span><span class="co">##  [49] base64enc_0.1-3             processx_3.8.2             </span></span>
<span><span class="co">##  [51] curl_5.1.0                  S4Vectors_0.38.2           </span></span>
<span><span class="co">##  [53] zlibbioc_1.46.0             polyclip_1.10-6            </span></span>
<span><span class="co">##  [55] randomForest_4.7-1.1        GenomeInfoDbData_1.2.10    </span></span>
<span><span class="co">##  [57] RBGL_1.76.0                 ncdfFlow_2.46.0            </span></span>
<span><span class="co">##  [59] RcppEigen_0.3.3.9.4         xtable_1.8-4               </span></span>
<span><span class="co">##  [61] stringr_1.5.0               desc_1.4.2                 </span></span>
<span><span class="co">##  [63] doParallel_1.0.17           evaluate_0.22              </span></span>
<span><span class="co">##  [65] S4Arrays_1.0.6              hms_1.1.3                  </span></span>
<span><span class="co">##  [67] glmnet_4.1-8                GenomicRanges_1.52.1       </span></span>
<span><span class="co">##  [69] irlba_2.3.5.1               colorspace_2.1-0           </span></span>
<span><span class="co">##  [71] harmony_1.1.0               reticulate_1.34.0          </span></span>
<span><span class="co">##  [73] readxl_1.4.3                magrittr_2.0.3             </span></span>
<span><span class="co">##  [75] lmtest_0.9-40               readr_2.1.4                </span></span>
<span><span class="co">##  [77] Rgraphviz_2.44.0            later_1.3.1                </span></span>
<span><span class="co">##  [79] lattice_0.22-5              future.apply_1.11.0        </span></span>
<span><span class="co">##  [81] robustbase_0.99-0           XML_3.99-0.15              </span></span>
<span><span class="co">##  [83] cowplot_1.1.1               matrixStats_1.1.0          </span></span>
<span><span class="co">##  [85] xts_0.13.1                  class_7.3-22               </span></span>
<span><span class="co">##  [87] Hmisc_5.1-1                 pillar_1.9.0               </span></span>
<span><span class="co">##  [89] nlme_3.1-163                iterators_1.0.14           </span></span>
<span><span class="co">##  [91] compiler_4.3.1              RSpectra_0.16-1            </span></span>
<span><span class="co">##  [93] stringi_1.7.12              gower_1.0.1                </span></span>
<span><span class="co">##  [95] minqa_1.2.6                 SummarizedExperiment_1.30.2</span></span>
<span><span class="co">##  [97] lubridate_1.9.3             devtools_2.4.5             </span></span>
<span><span class="co">##  [99] plyr_1.8.9                  crayon_1.5.2               </span></span>
<span><span class="co">## [101] abind_1.4-5                 locfit_1.5-9.8             </span></span>
<span><span class="co">## [103] sp_2.1-1                    sandwich_3.0-2             </span></span>
<span><span class="co">## [105] pcaMethods_1.92.0           codetools_0.2-19           </span></span>
<span><span class="co">## [107] multcomp_1.4-25             textshaping_0.3.7          </span></span>
<span><span class="co">## [109] recipes_1.0.8               openssl_2.1.1              </span></span>
<span><span class="co">## [111] Rphenograph_0.99.1          TTR_0.24.3                 </span></span>
<span><span class="co">## [113] bslib_0.5.1                 e1071_1.7-13               </span></span>
<span><span class="co">## [115] destiny_3.14.0              GetoptLong_1.0.5           </span></span>
<span><span class="co">## [117] ggplot.multistats_1.0.0     mime_0.12                  </span></span>
<span><span class="co">## [119] splines_4.3.1               circlize_0.4.15            </span></span>
<span><span class="co">## [121] Rcpp_1.0.11                 sparseMatrixStats_1.12.2   </span></span>
<span><span class="co">## [123] cellranger_1.1.0            knitr_1.44                 </span></span>
<span><span class="co">## [125] utf8_1.2.4                  clue_0.3-65                </span></span>
<span><span class="co">## [127] lme4_1.1-35.1               fs_1.6.3                   </span></span>
<span><span class="co">## [129] listenv_0.9.0               checkmate_2.3.0            </span></span>
<span><span class="co">## [131] DelayedMatrixStats_1.22.6   pkgbuild_1.4.2             </span></span>
<span><span class="co">## [133] ggsignif_0.6.4              tibble_3.2.1               </span></span>
<span><span class="co">## [135] Matrix_1.6-1.1              rpart.plot_3.1.1           </span></span>
<span><span class="co">## [137] callr_3.7.3                 tzdb_0.4.0                 </span></span>
<span><span class="co">## [139] tweenr_2.0.2                pkgconfig_2.0.3            </span></span>
<span><span class="co">## [141] pheatmap_1.0.12             tools_4.3.1                </span></span>
<span><span class="co">## [143] cachem_1.0.8                viridisLite_0.4.2          </span></span>
<span><span class="co">## [145] smoother_1.1                fastmap_1.1.1              </span></span>
<span><span class="co">## [147] rmarkdown_2.25              scales_1.2.1               </span></span>
<span><span class="co">## [149] grid_4.3.1                  usethis_2.2.2              </span></span>
<span><span class="co">## [151] broom_1.0.5                 sass_0.4.7                 </span></span>
<span><span class="co">## [153] graph_1.78.0                carData_3.0-5              </span></span>
<span><span class="co">## [155] RANN_2.6.1                  rpart_4.1.21               </span></span>
<span><span class="co">## [157] farver_2.1.1                yaml_2.3.7                 </span></span>
<span><span class="co">## [159] MatrixGenerics_1.12.3       foreign_0.8-85             </span></span>
<span><span class="co">## [161] ggthemes_4.2.4              cli_3.6.1                  </span></span>
<span><span class="co">## [163] purrr_1.0.2                 stats4_4.3.1               </span></span>
<span><span class="co">## [165] lifecycle_1.0.3             uwot_0.1.16                </span></span>
<span><span class="co">## [167] askpass_1.2.0               caret_6.0-94               </span></span>
<span><span class="co">## [169] mvtnorm_1.2-3               lava_1.7.3                 </span></span>
<span><span class="co">## [171] sessioninfo_1.2.2           backports_1.4.1            </span></span>
<span><span class="co">## [173] cytolib_2.12.1              timechange_0.2.0           </span></span>
<span><span class="co">## [175] gtable_0.3.4                rjson_0.2.21               </span></span>
<span><span class="co">## [177] umap_0.2.10.0               ggridges_0.5.4             </span></span>
<span><span class="co">## [179] parallel_4.3.1              pROC_1.18.5                </span></span>
<span><span class="co">## [181] limma_3.56.2                jsonlite_1.8.7             </span></span>
<span><span class="co">## [183] edgeR_3.42.4                RcppHNSW_0.5.0             </span></span>
<span><span class="co">## [185] bitops_1.0-7                Rtsne_0.16                 </span></span>
<span><span class="co">## [187] FlowSOM_2.8.0               ranger_0.16.0              </span></span>
<span><span class="co">## [189] flowCore_2.12.2             jquerylib_0.1.4            </span></span>
<span><span class="co">## [191] timeDate_4022.108           shiny_1.7.5.1              </span></span>
<span><span class="co">## [193] ConsensusClusterPlus_1.64.0 htmltools_0.5.6.1          </span></span>
<span><span class="co">## [195] diffcyt_1.20.0              glue_1.6.2                 </span></span>
<span><span class="co">## [197] XVector_0.40.0              VIM_6.2.2                  </span></span>
<span><span class="co">## [199] RCurl_1.98-1.13             rprojroot_2.0.3            </span></span>
<span><span class="co">## [201] gridExtra_2.3               boot_1.3-28.1              </span></span>
<span><span class="co">## [203] TrajectoryUtils_1.8.0       igraph_1.5.1               </span></span>
<span><span class="co">## [205] R6_2.5.1                    tidyr_1.3.0                </span></span>
<span><span class="co">## [207] SingleCellExperiment_1.22.0 labeling_0.4.3             </span></span>
<span><span class="co">## [209] vcd_1.4-11                  cluster_2.1.4              </span></span>
<span><span class="co">## [211] pkgload_1.3.3               GenomeInfoDb_1.36.4        </span></span>
<span><span class="co">## [213] ipred_0.9-14                nloptr_2.0.3               </span></span>
<span><span class="co">## [215] DelayedArray_0.26.7         tidyselect_1.2.0           </span></span>
<span><span class="co">## [217] vipor_0.4.5                 htmlTable_2.4.2            </span></span>
<span><span class="co">## [219] ggforce_0.4.1               CytoDx_1.20.0              </span></span>
<span><span class="co">## [221] car_3.1-2                   future_1.33.0              </span></span>
<span><span class="co">## [223] ModelMetrics_1.2.2.2        munsell_0.5.0              </span></span>
<span><span class="co">## [225] laeken_0.5.2                data.table_1.14.8          </span></span>
<span><span class="co">## [227] htmlwidgets_1.6.2           ComplexHeatmap_2.16.0      </span></span>
<span><span class="co">## [229] RColorBrewer_1.1-3          rlang_1.1.1                </span></span>
<span><span class="co">## [231] remotes_2.4.2.1             colorRamps_2.3.1           </span></span>
<span><span class="co">## [233] ggnewscale_0.4.9            fansi_1.0.5                </span></span>
<span><span class="co">## [235] hardhat_1.3.0               beeswarm_0.4.0             </span></span>
<span><span class="co">## [237] prodlim_2023.08.28</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Lorenzo Bonaguro, Charlotte Kroeger, Sophie Mueller, Jacqueline Leidner.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
