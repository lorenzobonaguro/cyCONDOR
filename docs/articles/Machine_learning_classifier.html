<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="cyCONDOR">
<title>Machine learning classifier â€¢ cyCONDOR</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Machine learning classifier">
<meta property="og:description" content="cyCONDOR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">cyCONDOR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.2.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/cyCONDOR.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/Prepare_data_for_cyCONDOR_analysis.html">Prepare data for cyCONDOR analysis</a>
    <a class="dropdown-item" href="../articles/How_to_run_cyCONDOR_as_container.html">How to run cyCONDOR as container</a>
    <a class="dropdown-item" href="../articles/Data_Loading_and_Transformation.html">Data Loading and Transformation</a>
    <a class="dropdown-item" href="../articles/Load_a_FlowJo_workspace.html">Load a FlowJo workspace</a>
    <a class="dropdown-item" href="../articles/Dimensionality_Reduction.html">Dimensionality Reduction</a>
    <a class="dropdown-item" href="../articles/Clustering_and_cell_annotation.html">Clustering and cell annotation</a>
    <a class="dropdown-item" href="../articles/Batch_correction.html">Batch correction</a>
    <a class="dropdown-item" href="../articles/Data_Visualization.html">Data Visualization</a>
    <a class="dropdown-item" href="../articles/Differential_Analysis.html">Differential Analysis with cyCONDOR</a>
    <a class="dropdown-item" href="../articles/Pseudotime_analysis.html">Pseudotime analysis</a>
    <a class="dropdown-item" href="../articles/Data_Projection.html">Data Projection</a>
    <a class="dropdown-item" href="../articles/Machine_learning_classifier.html">Machine learning classifier</a>
    <a class="dropdown-item" href="../articles/Cell_type_prediction.html">Cell type prediction</a>
    <a class="dropdown-item" href="../articles/Other_utilities.html">Introduction to the condor object and other utilities</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/lorenzobonaguro/condor/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Machine learning classifier</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/lorenzobonaguro/condor/blob/HEAD/vignettes/Machine_learning_classifier.Rmd" class="external-link"><code>vignettes/Machine_learning_classifier.Rmd</code></a></small>
      <div class="d-none name"><code>Machine_learning_classifier.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/lorenzobonaguro/condor" class="external-link">cyCONDOR</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">CytoDx</span><span class="op">)</span></span></code></pre></div>
<p>With <code>cyCONDOR</code> we developed a set of functions allowing
the user to easily train a classifier for the sample labels. In this
vignette we exemplify all the steps required for the classification of
AML (acute myeloid leukemia) and control samples. The trained model can
then be used to predict the label of and external sample. This workflow
is based on the <code>CytoDX</code> package, for detailed documentation
see the original manuscript <a href="https://academic.oup.com/bioinformatics/article/35/7/1197/5088319" class="external-link">Hu
et. al, 2019, Bioinformatics</a> and <code>cytoDX</code>documentation of
<a href="https://bioconductor.org/packages/release/bioc/html/CytoDx.html" class="external-link">Bioconductor</a>.</p>
<p>We will start the vignette by loading a training dataset, in this
dataset the clinical classification of the sample is known and will be
used to train a <code>cytoDX</code> model. In <code>cyCONDOR</code> the
<code>cytoDX</code> model is saved withing the <code>condor</code>
object and can be used to classify new samples.</p>
<p>If you use this workflow in your work please consider citing <a href="XXX">cyCONDOR</a> and <a href="https://academic.oup.com/bioinformatics/article/35/7/1197/5088319" class="external-link">cytoDX</a>.</p>
<p><br></p>
<div class="section level2">
<h2 id="train-the-cytodx-model">Train the <code>cytoDX</code> model<a class="anchor" aria-label="anchor" href="#train-the-cytodx-model"></a>
</h2>
<div class="section level3">
<h3 id="load-the-data">Load the data<a class="anchor" aria-label="anchor" href="#load-the-data"></a>
</h3>
<p>We start by importing the training dataset, this is done as
previously described with the <code>prep_fcd</code> function, in this
case the <code>anno_table</code> also include the clinical
classification of the samples (<code>aml</code> or
<code>normal</code>).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_fcd.html">prep_fcd</a></span><span class="op">(</span>data_path <span class="op">=</span> <span class="st">"../../../Figure 7 - Clinical Classifier/data_and_envs/CytoDX/train/"</span>, </span>
<span>                   max_cell <span class="op">=</span> <span class="fl">10000000</span>, </span>
<span>                   useCSV <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                   transformation <span class="op">=</span> <span class="st">"auto_logi"</span>, </span>
<span>                   remove_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FSC-A"</span>,<span class="st">"FSC-W"</span>,<span class="st">"FSC-H"</span>,<span class="st">"Time"</span><span class="op">)</span>, </span>
<span>                   anno_table <span class="op">=</span> <span class="st">"../../../Figure 7 - Clinical Classifier/data_and_envs/CytoDX/fcs_info_train.csv"</span>, </span>
<span>                   filename_col <span class="op">=</span> <span class="st">"fcsName"</span>,</span>
<span>                   seed <span class="op">=</span> <span class="fl">91</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="build-the-classifier-model">Build the classifier model<a class="anchor" aria-label="anchor" href="#build-the-classifier-model"></a>
</h3>
<p>We now train the <code>cytoDX</code> classifier on the sample label,
this step does not require any other pre-analysis on the dataset,
nevertheless, if you are not familiar with the data you are using for
training we recommend an exploratory data analysis first.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Re order variables - this is not strictly needed but the classification always consider the first variable as reference.</span></span>
<span></span>
<span><span class="va">condor</span><span class="op">$</span><span class="va">anno</span><span class="op">$</span><span class="va">cell_anno</span><span class="op">$</span><span class="va">Label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">condor</span><span class="op">$</span><span class="va">anno</span><span class="op">$</span><span class="va">cell_anno</span><span class="op">$</span><span class="va">Label</span>, </span>
<span>                                      levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"aml"</span><span class="op">)</span>, </span>
<span>                                      labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1_normal"</span>, <span class="st">"2_aml"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The <code>train_classifier_model</code> requires the user to define
the input table and few parameter to be used for training the
<code>cytoDX</code> model. As some of the variables are derived from the
<code>cytoDX</code> package (<code>cytoDX.fit</code> function) please
refer to <code>cytoDX</code> documentation for further details.</p>
<ul>
<li>fcd: Flow cytometry data set to be used for training the model.</li>
<li>input_type: data slot to be used for the classification, suggested
<code>expr</code>.</li>
<li>data slot: exact name of the data slot to be used (<code>orig</code>
or <code>norm</code>, if batch correction was performed).</li>
<li>sample_names: name of the column of the <code>anno_table</code>
containing the sample names.</li>
<li>classification_variable: name of the column of the
<code>anno_table</code> containing the clinical classification to be
used for training the classifier.</li>
<li>type1: type of first level prediction, parameter inherited from
<code>cytoDX</code>, see <code>cytoDX</code> documentation for
details.</li>
<li>type2: type of second level prediction, parameter inherited from
<code>cytoDX</code>, see <code>cytoDX</code> documentation for
details.</li>
<li>parallelCore: number of cores to be used.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/train_classifier_model.html">train_classifier_model</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor</span>, </span>
<span>                                 input_type <span class="op">=</span> <span class="st">"expr"</span>, </span>
<span>                                 data_slot <span class="op">=</span> <span class="st">"orig"</span>, </span>
<span>                                 sample_names <span class="op">=</span> <span class="st">"expfcs_filename"</span>, </span>
<span>                                 classification_variable <span class="op">=</span> <span class="va">condor</span><span class="op">$</span><span class="va">anno</span><span class="op">$</span><span class="va">cell_anno</span><span class="op">$</span><span class="va">Label</span>, </span>
<span>                                 family <span class="op">=</span> <span class="st">"binomial"</span>, </span>
<span>                                 type1 <span class="op">=</span> <span class="st">"response"</span>, </span>
<span>                                 parallelCore <span class="op">=</span> <span class="fl">1</span>, </span>
<span>                                 reg <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                 seed <span class="op">=</span> <span class="fl">91</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in lognet(xd, is.sparse, ix, jx, y, weights, offset, alpha, nobs, : one</span></span>
<span><span class="co">## multinomial or binomial class has fewer than 8 observations; dangerous ground</span></span></code></pre>
</div>
<div class="section level3">
<h3 id="explore-the-result-of-model-training">Explore the result of model training<a class="anchor" aria-label="anchor" href="#explore-the-result-of-model-training"></a>
</h3>
<p>We can now explore the results of the cell level and sample level
prediction on the training data. The results are stored together with
the <code>cytoDX</code> model itself in the <code>extras</code> slot
(<code>classifier_model</code>)</p>
<div class="section level4">
<h4 id="cell-level-predition-result-on-the-training-dataset">Cell level predition result on the training dataset<a class="anchor" aria-label="anchor" href="#cell-level-predition-result-on-the-training-dataset"></a>
</h4>
<p>The cellular level result contain the probability of classification
to <code>aml</code> for each cell in the dataset, this table also
include the true label of each cell.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">condor</span><span class="op">$</span><span class="va">extras</span><span class="op">$</span><span class="va">classifier_model</span><span class="op">$</span><span class="va">train.Data.cell</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         sample y1.Truth y.Pred.s0</span></span>
<span><span class="co">## 1 sample11.fcs    2_aml 0.5836773</span></span>
<span><span class="co">## 2 sample11.fcs    2_aml 0.5299637</span></span>
<span><span class="co">## 3 sample11.fcs    2_aml 0.6896542</span></span>
<span><span class="co">## 4 sample11.fcs    2_aml 0.4914881</span></span>
<span><span class="co">## 5 sample11.fcs    2_aml 0.5393115</span></span>
<span><span class="co">## 6 sample11.fcs    2_aml 0.3407959</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="sample-level-predition-result-on-the-training-dataset">Sample level predition result on the training dataset<a class="anchor" aria-label="anchor" href="#sample-level-predition-result-on-the-training-dataset"></a>
</h4>
<p>The sample level result contain the probability of classification to
<code>aml</code> for each cell in the dataset, this table also include
the true label of each cell.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">condor</span><span class="op">$</span><span class="va">extras</span><span class="op">$</span><span class="va">classifier_model</span><span class="op">$</span><span class="va">train.Data.sample</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                    sample y1.Truth    y.Pred.s0</span></span>
<span><span class="co">## sample11.fcs sample11.fcs    2_aml 1.000000e+00</span></span>
<span><span class="co">## sample12.fcs sample12.fcs    2_aml 1.000000e+00</span></span>
<span><span class="co">## sample13.fcs sample13.fcs    2_aml 9.999999e-01</span></span>
<span><span class="co">## sample14.fcs sample14.fcs    2_aml 1.000000e+00</span></span>
<span><span class="co">## sample15.fcs sample15.fcs    2_aml 1.000000e+00</span></span>
<span><span class="co">## sample16.fcs sample16.fcs 1_normal 5.949578e-14</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="visualize-the-results-on-the-train-dataset">Visualize the results on the train dataset<a class="anchor" aria-label="anchor" href="#visualize-the-results-on-the-train-dataset"></a>
</h4>
<p>We can now visualize the prediction result both at cell and sample
level.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"../../../Figure 7 - Clinical Classifier/data_and_envs/CytoDX/fcs_info_train.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condor</span><span class="op">$</span><span class="va">extras</span><span class="op">$</span><span class="va">classifier_model</span><span class="op">$</span><span class="va">train.Data.cell</span>, y <span class="op">=</span> <span class="va">anno</span>, by.x <span class="op">=</span> <span class="st">"sample"</span>, by.y <span class="op">=</span> <span class="st">"fcsName"</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sample</span>, y <span class="op">=</span> <span class="va">y.Pred.s0</span>, color <span class="op">=</span> <span class="va">Label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#92278F"</span>, <span class="st">"#F15A29"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"probability"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"sample level prediction - train data"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Machine_learning_classifier_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condor</span><span class="op">$</span><span class="va">extras</span><span class="op">$</span><span class="va">classifier_model</span><span class="op">$</span><span class="va">train.Data.sample</span>, y <span class="op">=</span> <span class="va">anno</span>, by.x <span class="op">=</span> <span class="st">"sample"</span>, by.y <span class="op">=</span> <span class="st">"fcsName"</span><span class="op">)</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sample</span>, y <span class="op">=</span> <span class="va">y.Pred.s0</span>, color <span class="op">=</span> <span class="va">Label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#92278F"</span>, <span class="st">"#F15A29"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"sample level prediction - train data"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Machine_learning_classifier_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
</div>
<div class="section level4">
<h4 id="visualization-of-the-decision-tree">Visualization of the decision tree<a class="anchor" aria-label="anchor" href="#visualization-of-the-decision-tree"></a>
</h4>
<p>We can use a <code>cytoDX</code> built-in function to visualize the
decision tree used for the cell level classification. See
<code>cytoDX</code> documentation for further details.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/CytoDx/man/treeGate.html" class="external-link">treeGate</a></span><span class="op">(</span>P <span class="op">=</span> <span class="va">condor</span><span class="op">$</span><span class="va">extras</span><span class="op">$</span><span class="va">classifier_model</span><span class="op">$</span><span class="va">train.Data.cell</span><span class="op">$</span><span class="va">y.Pred.s0</span>,</span>
<span>                 x<span class="op">=</span> <span class="va">condor</span><span class="op">$</span><span class="va">expr</span><span class="op">$</span><span class="va">orig</span><span class="op">)</span></span></code></pre></div>
<p><img src="Machine_learning_classifier_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="testing-on-an-independent-dataset">Testing on an independent dataset<a class="anchor" aria-label="anchor" href="#testing-on-an-independent-dataset"></a>
</h2>
<div class="section level3">
<h3 id="load-the-data-1">Load the data<a class="anchor" aria-label="anchor" href="#load-the-data-1"></a>
</h3>
<p>To now validate the performance of the trained <code>cytoDX</code>
model we will test it on a test dataset with no overlap with the
training data.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prep_fcd.html">prep_fcd</a></span><span class="op">(</span>data_path <span class="op">=</span> <span class="st">"../../../Figure 7 - Clinical Classifier/data_and_envs/CytoDX/test/"</span>, </span>
<span>                        max_cell <span class="op">=</span> <span class="fl">10000000</span>, </span>
<span>                        useCSV <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                        transformation <span class="op">=</span> <span class="st">"auto_logi"</span>, </span>
<span>                        remove_param <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"FSC-A"</span>,<span class="st">"FSC-W"</span>,<span class="st">"FSC-H"</span>,<span class="st">"Time"</span><span class="op">)</span>, </span>
<span>                        anno_table <span class="op">=</span> <span class="st">"../../../Figure 7 - Clinical Classifier/data_and_envs/CytoDX/fcs_info_test.csv"</span>, </span>
<span>                        filename_col <span class="op">=</span> <span class="st">"fcsName"</span>,</span>
<span>                        seed <span class="op">=</span> <span class="fl">91</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="predict-classification">Predict classification<a class="anchor" aria-label="anchor" href="#predict-classification"></a>
</h3>
<p>We can now predict the label using the trained model</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Re order variables - this is not strictly needed but the classification always consider the first variable as reference.</span></span>
<span></span>
<span><span class="va">condor_test</span><span class="op">$</span><span class="va">anno</span><span class="op">$</span><span class="va">cell_anno</span><span class="op">$</span><span class="va">Label</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">condor_test</span><span class="op">$</span><span class="va">anno</span><span class="op">$</span><span class="va">cell_anno</span><span class="op">$</span><span class="va">Label</span>, </span>
<span>                                           levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"normal"</span>, <span class="st">"aml"</span><span class="op">)</span>, </span>
<span>                                           labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1_normal"</span>, <span class="st">"2_aml"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>The <code>predict_classifier</code> requires few user defined input
to predict the labels of an external dataset using a previously prepared
<code>cytoDX</code> model.</p>
<ul>
<li>fcd: flow cytometri dataset of the new data</li>
<li>input_type: data slot to be used for the classification, suggested
<code>expr</code>. Should match the option selection in
<code>train_classifier_model</code>.</li>
<li>data slot: exact name of the data slot to be used (<code>orig</code>
or <code>norm</code>, if batch correction was performed). Should match
the option selection in <code>train_classifier_model</code>.</li>
<li>sample_names: name of the column in the <code>anno_table</code>
containing the sample names.</li>
<li>model_object: <code>cyCONDOR</code> trained <code>cytoDX</code>
model, this is stored in the <code>condor</code> object used to train
the model (<code>extras</code> slot).</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">condor_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/predict_classifier.html">predict_classifier</a></span><span class="op">(</span>fcd <span class="op">=</span> <span class="va">condor_test</span>, </span>
<span>                                  input_type <span class="op">=</span> <span class="st">"expr"</span>, </span>
<span>                                  data_slot <span class="op">=</span> <span class="st">"orig"</span>, </span>
<span>                                  sample_names <span class="op">=</span> <span class="st">"expfcs_filename"</span>, </span>
<span>                                  model_object <span class="op">=</span> <span class="va">condor</span><span class="op">$</span><span class="va">extras</span><span class="op">$</span><span class="va">classifier_model</span>, </span>
<span>                                  seed <span class="op">=</span> <span class="fl">91</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="explore-the-result-of-prediction-in-test-dataset">Explore the result of prediction in test dataset<a class="anchor" aria-label="anchor" href="#explore-the-result-of-prediction-in-test-dataset"></a>
</h3>
<p>We can now explore the results of the cell level and sample level
prediction on the test data. The results are stored together with the
<code>cytoDX</code> model itself in the <code>extras</code> slot
(<code>classifier_prediction</code>)</p>
<div class="section level4">
<h4 id="cell-level-predition-result-on-the-test-dataset">Cell level predition result on the test dataset<a class="anchor" aria-label="anchor" href="#cell-level-predition-result-on-the-test-dataset"></a>
</h4>
<p>The cellular level result contain the probability of classification
to <code>aml</code> for each cell in the dataset.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">condor_test</span><span class="op">$</span><span class="va">extras</span><span class="op">$</span><span class="va">classifier_prediction</span><span class="op">$</span><span class="va">xNew.Pred.cell</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##        sample y.Pred.s0</span></span>
<span><span class="co">## 1 sample1.fcs 0.6212374</span></span>
<span><span class="co">## 2 sample1.fcs 0.6780328</span></span>
<span><span class="co">## 3 sample1.fcs 0.5818562</span></span>
<span><span class="co">## 4 sample1.fcs 0.3354043</span></span>
<span><span class="co">## 5 sample1.fcs 0.4015879</span></span>
<span><span class="co">## 6 sample1.fcs 0.7143018</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="cell-level-predition-result-on-the-test-dataset-1">Cell level predition result on the test dataset<a class="anchor" aria-label="anchor" href="#cell-level-predition-result-on-the-test-dataset-1"></a>
</h4>
<p>The sample level result contain the probability of classification to
<code>aml</code> for each cell in the dataset.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">condor_test</span><span class="op">$</span><span class="va">extras</span><span class="op">$</span><span class="va">classifier_prediction</span><span class="op">$</span><span class="va">xNew.Pred.sample</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                    sample    y.Pred.s0</span></span>
<span><span class="co">## sample1.fcs   sample1.fcs 1.000000e+00</span></span>
<span><span class="co">## sample10.fcs sample10.fcs 6.021657e-12</span></span>
<span><span class="co">## sample2.fcs   sample2.fcs 1.000000e+00</span></span>
<span><span class="co">## sample3.fcs   sample3.fcs 9.998114e-01</span></span>
<span><span class="co">## sample4.fcs   sample4.fcs 1.000000e+00</span></span>
<span><span class="co">## sample5.fcs   sample5.fcs 1.000000e+00</span></span></code></pre>
</div>
<div class="section level4">
<h4 id="visualize-the-results-on-the-test-dataset">Visualize the results on the test dataset<a class="anchor" aria-label="anchor" href="#visualize-the-results-on-the-test-dataset"></a>
</h4>
<p>We can now visualize the prediction result both at cell and sample
level.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">anno</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html" class="external-link">read.csv</a></span><span class="op">(</span><span class="st">"../../../Figure 7 - Clinical Classifier/data_and_envs/CytoDX/fcs_info_test.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condor_test</span><span class="op">$</span><span class="va">extras</span><span class="op">$</span><span class="va">classifier_prediction</span><span class="op">$</span><span class="va">xNew.Pred.cell</span>, y <span class="op">=</span> <span class="va">anno</span>, by.x <span class="op">=</span> <span class="st">"sample"</span>, by.y <span class="op">=</span> <span class="st">"fcsName"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp</span><span class="op">$</span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">$</span><span class="va">sample</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample1.fcs"</span>, <span class="st">"sample2.fcs"</span>, <span class="st">"sample3.fcs"</span>,  <span class="st">"sample4.fcs"</span>,  <span class="st">"sample5.fcs"</span>,  <span class="st">"sample6.fcs"</span>,  <span class="st">"sample7.fcs"</span>,  <span class="st">"sample8.fcs"</span>,  <span class="st">"sample9.fcs"</span>, <span class="st">"sample10.fcs"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sample</span>, y <span class="op">=</span> <span class="va">y.Pred.s0</span>, color <span class="op">=</span> <span class="va">Label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html" class="external-link">geom_jitter</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_violin.html" class="external-link">geom_violin</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#92278F"</span>, <span class="st">"#F15A29"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"cell level prediction - test data"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Machine_learning_classifier_files/figure-html/unnamed-chunk-14-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tmp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">condor_test</span><span class="op">$</span><span class="va">extras</span><span class="op">$</span><span class="va">classifier_prediction</span><span class="op">$</span><span class="va">xNew.Pred.sample</span>, y <span class="op">=</span> <span class="va">anno</span>, by.x <span class="op">=</span> <span class="st">"sample"</span>, by.y <span class="op">=</span> <span class="st">"fcsName"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">tmp</span><span class="op">$</span><span class="va">sample</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">$</span><span class="va">sample</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sample1.fcs"</span>, <span class="st">"sample2.fcs"</span>, <span class="st">"sample3.fcs"</span>,  <span class="st">"sample4.fcs"</span>,  <span class="st">"sample5.fcs"</span>,  <span class="st">"sample6.fcs"</span>,  <span class="st">"sample7.fcs"</span>,  <span class="st">"sample8.fcs"</span>,  <span class="st">"sample9.fcs"</span>, <span class="st">"sample10.fcs"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">sample</span>, y <span class="op">=</span> <span class="va">y.Pred.s0</span>, color <span class="op">=</span> <span class="va">Label</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_color_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"#92278F"</span>, <span class="st">"#F15A29"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_bw</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>aspect.ratio <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ylab</a></span><span class="op">(</span><span class="st">"probability"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">ggtitle</a></span><span class="op">(</span><span class="st">"sample level prediction - test data"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>axis.text.x <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>angle <span class="op">=</span> <span class="fl">45</span>, hjust <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="Machine_learning_classifier_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/rm.html" class="external-link">rm</a></span><span class="op">(</span><span class="va">tmp</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
</div>
<div class="section level2">
<h2 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h2>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">info</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">info</span></span></code></pre></div>
<pre><code><span><span class="co">## R version 4.3.1 (2023-06-16)</span></span>
<span><span class="co">## Platform: x86_64-pc-linux-gnu (64-bit)</span></span>
<span><span class="co">## Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Matrix products: default</span></span>
<span><span class="co">## BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">## LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## locale:</span></span>
<span><span class="co">##  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C              </span></span>
<span><span class="co">##  [3] LC_TIME=en_US.UTF-8        LC_COLLATE=en_US.UTF-8    </span></span>
<span><span class="co">##  [5] LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">##  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                 </span></span>
<span><span class="co">##  [9] LC_ADDRESS=C               LC_TELEPHONE=C            </span></span>
<span><span class="co">## [11] LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## time zone: Etc/UTC</span></span>
<span><span class="co">## tzcode source: system (glibc)</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## attached base packages:</span></span>
<span><span class="co">## [1] stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">## </span></span>
<span><span class="co">## other attached packages:</span></span>
<span><span class="co">## [1] CytoDx_1.20.0  ggplot2_3.4.4  cyCONDOR_0.2.1</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## loaded via a namespace (and not attached):</span></span>
<span><span class="co">##   [1] IRanges_2.34.1              Rmisc_1.5.1                </span></span>
<span><span class="co">##   [3] urlchecker_1.0.1            nnet_7.3-19                </span></span>
<span><span class="co">##   [5] CytoNorm_2.0.1              TH.data_1.1-2              </span></span>
<span><span class="co">##   [7] vctrs_0.6.4                 digest_0.6.33              </span></span>
<span><span class="co">##   [9] png_0.1-8                   shape_1.4.6                </span></span>
<span><span class="co">##  [11] proxy_0.4-27                slingshot_2.8.0            </span></span>
<span><span class="co">##  [13] ggrepel_0.9.4               parallelly_1.36.0          </span></span>
<span><span class="co">##  [15] MASS_7.3-60                 pkgdown_2.0.7              </span></span>
<span><span class="co">##  [17] reshape2_1.4.4              httpuv_1.6.12              </span></span>
<span><span class="co">##  [19] foreach_1.5.2               BiocGenerics_0.46.0        </span></span>
<span><span class="co">##  [21] withr_2.5.1                 ggrastr_1.0.2              </span></span>
<span><span class="co">##  [23] xfun_0.40                   ggpubr_0.6.0               </span></span>
<span><span class="co">##  [25] ellipsis_0.3.2              survival_3.5-7             </span></span>
<span><span class="co">##  [27] memoise_2.0.1               hexbin_1.28.3              </span></span>
<span><span class="co">##  [29] ggbeeswarm_0.7.2            RProtoBufLib_2.12.1        </span></span>
<span><span class="co">##  [31] princurve_2.1.6             profvis_0.3.8              </span></span>
<span><span class="co">##  [33] ggsci_3.0.0                 systemfonts_1.0.5          </span></span>
<span><span class="co">##  [35] ragg_1.2.6                  zoo_1.8-12                 </span></span>
<span><span class="co">##  [37] GlobalOptions_0.1.2         DEoptimR_1.1-3             </span></span>
<span><span class="co">##  [39] Formula_1.2-5               prettyunits_1.2.0          </span></span>
<span><span class="co">##  [41] promises_1.2.1              scatterplot3d_0.3-44       </span></span>
<span><span class="co">##  [43] rstatix_0.7.2               globals_0.16.2             </span></span>
<span><span class="co">##  [45] ps_1.7.5                    rstudioapi_0.15.0          </span></span>
<span><span class="co">##  [47] miniUI_0.1.1.1              generics_0.1.3             </span></span>
<span><span class="co">##  [49] ggcyto_1.28.1               base64enc_0.1-3            </span></span>
<span><span class="co">##  [51] processx_3.8.2              curl_5.1.0                 </span></span>
<span><span class="co">##  [53] S4Vectors_0.38.2            zlibbioc_1.46.0            </span></span>
<span><span class="co">##  [55] flowWorkspace_4.12.2        polyclip_1.10-6            </span></span>
<span><span class="co">##  [57] randomForest_4.7-1.1        GenomeInfoDbData_1.2.10    </span></span>
<span><span class="co">##  [59] RBGL_1.76.0                 ncdfFlow_2.46.0            </span></span>
<span><span class="co">##  [61] RcppEigen_0.3.3.9.4         xtable_1.8-4               </span></span>
<span><span class="co">##  [63] stringr_1.5.0               desc_1.4.2                 </span></span>
<span><span class="co">##  [65] doParallel_1.0.17           evaluate_0.22              </span></span>
<span><span class="co">##  [67] S4Arrays_1.0.6              hms_1.1.3                  </span></span>
<span><span class="co">##  [69] glmnet_4.1-8                GenomicRanges_1.52.1       </span></span>
<span><span class="co">##  [71] irlba_2.3.5.1               colorspace_2.1-0           </span></span>
<span><span class="co">##  [73] harmony_1.1.0               reticulate_1.34.0          </span></span>
<span><span class="co">##  [75] readxl_1.4.3                magrittr_2.0.3             </span></span>
<span><span class="co">##  [77] lmtest_0.9-40               readr_2.1.4                </span></span>
<span><span class="co">##  [79] Rgraphviz_2.44.0            later_1.3.1                </span></span>
<span><span class="co">##  [81] lattice_0.22-5              future.apply_1.11.0        </span></span>
<span><span class="co">##  [83] robustbase_0.99-0           XML_3.99-0.15              </span></span>
<span><span class="co">##  [85] cowplot_1.1.1               matrixStats_1.1.0          </span></span>
<span><span class="co">##  [87] xts_0.13.1                  class_7.3-22               </span></span>
<span><span class="co">##  [89] Hmisc_5.1-1                 pillar_1.9.0               </span></span>
<span><span class="co">##  [91] nlme_3.1-163                iterators_1.0.14           </span></span>
<span><span class="co">##  [93] compiler_4.3.1              RSpectra_0.16-1            </span></span>
<span><span class="co">##  [95] stringi_1.7.12              gower_1.0.1                </span></span>
<span><span class="co">##  [97] minqa_1.2.6                 SummarizedExperiment_1.30.2</span></span>
<span><span class="co">##  [99] lubridate_1.9.3             devtools_2.4.5             </span></span>
<span><span class="co">## [101] CytoML_2.12.0               plyr_1.8.9                 </span></span>
<span><span class="co">## [103] crayon_1.5.2                abind_1.4-5                </span></span>
<span><span class="co">## [105] locfit_1.5-9.8              sp_2.1-1                   </span></span>
<span><span class="co">## [107] sandwich_3.0-2              pcaMethods_1.92.0          </span></span>
<span><span class="co">## [109] dplyr_1.1.3                 codetools_0.2-19           </span></span>
<span><span class="co">## [111] multcomp_1.4-25             textshaping_0.3.7          </span></span>
<span><span class="co">## [113] recipes_1.0.8               openssl_2.1.1              </span></span>
<span><span class="co">## [115] Rphenograph_0.99.1          TTR_0.24.3                 </span></span>
<span><span class="co">## [117] bslib_0.5.1                 e1071_1.7-13               </span></span>
<span><span class="co">## [119] destiny_3.14.0              GetoptLong_1.0.5           </span></span>
<span><span class="co">## [121] ggplot.multistats_1.0.0     mime_0.12                  </span></span>
<span><span class="co">## [123] splines_4.3.1               circlize_0.4.15            </span></span>
<span><span class="co">## [125] Rcpp_1.0.11                 sparseMatrixStats_1.12.2   </span></span>
<span><span class="co">## [127] cellranger_1.1.0            knitr_1.44                 </span></span>
<span><span class="co">## [129] utf8_1.2.4                  clue_0.3-65                </span></span>
<span><span class="co">## [131] lme4_1.1-35.1               fs_1.6.3                   </span></span>
<span><span class="co">## [133] listenv_0.9.0               checkmate_2.3.0            </span></span>
<span><span class="co">## [135] DelayedMatrixStats_1.22.6   pkgbuild_1.4.2             </span></span>
<span><span class="co">## [137] ggsignif_0.6.4              tibble_3.2.1               </span></span>
<span><span class="co">## [139] Matrix_1.6-1.1              rpart.plot_3.1.1           </span></span>
<span><span class="co">## [141] callr_3.7.3                 tzdb_0.4.0                 </span></span>
<span><span class="co">## [143] tweenr_2.0.2                pkgconfig_2.0.3            </span></span>
<span><span class="co">## [145] pheatmap_1.0.12             tools_4.3.1                </span></span>
<span><span class="co">## [147] cachem_1.0.8                smoother_1.1               </span></span>
<span><span class="co">## [149] fastmap_1.1.1               rmarkdown_2.25             </span></span>
<span><span class="co">## [151] scales_1.2.1                grid_4.3.1                 </span></span>
<span><span class="co">## [153] usethis_2.2.2               broom_1.0.5                </span></span>
<span><span class="co">## [155] sass_0.4.7                  graph_1.78.0               </span></span>
<span><span class="co">## [157] carData_3.0-5               RANN_2.6.1                 </span></span>
<span><span class="co">## [159] rpart_4.1.21                farver_2.1.1               </span></span>
<span><span class="co">## [161] yaml_2.3.7                  MatrixGenerics_1.12.3      </span></span>
<span><span class="co">## [163] foreign_0.8-85              ggthemes_4.2.4             </span></span>
<span><span class="co">## [165] cli_3.6.1                   purrr_1.0.2                </span></span>
<span><span class="co">## [167] stats4_4.3.1                lifecycle_1.0.3            </span></span>
<span><span class="co">## [169] uwot_0.1.16                 askpass_1.2.0              </span></span>
<span><span class="co">## [171] caret_6.0-94                Biobase_2.60.0             </span></span>
<span><span class="co">## [173] mvtnorm_1.2-3               lava_1.7.3                 </span></span>
<span><span class="co">## [175] sessioninfo_1.2.2           backports_1.4.1            </span></span>
<span><span class="co">## [177] cytolib_2.12.1              timechange_0.2.0           </span></span>
<span><span class="co">## [179] gtable_0.3.4                rjson_0.2.21               </span></span>
<span><span class="co">## [181] umap_0.2.10.0               ggridges_0.5.4             </span></span>
<span><span class="co">## [183] parallel_4.3.1              pROC_1.18.5                </span></span>
<span><span class="co">## [185] limma_3.56.2                jsonlite_1.8.7             </span></span>
<span><span class="co">## [187] edgeR_3.42.4                RcppHNSW_0.5.0             </span></span>
<span><span class="co">## [189] bitops_1.0-7                Rtsne_0.16                 </span></span>
<span><span class="co">## [191] FlowSOM_2.8.0               ranger_0.16.0              </span></span>
<span><span class="co">## [193] flowCore_2.12.2             jquerylib_0.1.4            </span></span>
<span><span class="co">## [195] timeDate_4022.108           shiny_1.7.5.1              </span></span>
<span><span class="co">## [197] ConsensusClusterPlus_1.64.0 htmltools_0.5.6.1          </span></span>
<span><span class="co">## [199] diffcyt_1.20.0              glue_1.6.2                 </span></span>
<span><span class="co">## [201] XVector_0.40.0              VIM_6.2.2                  </span></span>
<span><span class="co">## [203] RCurl_1.98-1.13             rprojroot_2.0.3            </span></span>
<span><span class="co">## [205] gridExtra_2.3               boot_1.3-28.1              </span></span>
<span><span class="co">## [207] TrajectoryUtils_1.8.0       igraph_1.5.1               </span></span>
<span><span class="co">## [209] R6_2.5.1                    tidyr_1.3.0                </span></span>
<span><span class="co">## [211] SingleCellExperiment_1.22.0 labeling_0.4.3             </span></span>
<span><span class="co">## [213] vcd_1.4-11                  cluster_2.1.4              </span></span>
<span><span class="co">## [215] pkgload_1.3.3               GenomeInfoDb_1.36.4        </span></span>
<span><span class="co">## [217] ipred_0.9-14                nloptr_2.0.3               </span></span>
<span><span class="co">## [219] DelayedArray_0.26.7         tidyselect_1.2.0           </span></span>
<span><span class="co">## [221] vipor_0.4.5                 htmlTable_2.4.2            </span></span>
<span><span class="co">## [223] ggforce_0.4.1               car_3.1-2                  </span></span>
<span><span class="co">## [225] future_1.33.0               ModelMetrics_1.2.2.2       </span></span>
<span><span class="co">## [227] munsell_0.5.0               laeken_0.5.2               </span></span>
<span><span class="co">## [229] data.table_1.14.8           htmlwidgets_1.6.2          </span></span>
<span><span class="co">## [231] ComplexHeatmap_2.16.0       RColorBrewer_1.1-3         </span></span>
<span><span class="co">## [233] rlang_1.1.1                 remotes_2.4.2.1            </span></span>
<span><span class="co">## [235] colorRamps_2.3.1            ggnewscale_0.4.9           </span></span>
<span><span class="co">## [237] fansi_1.0.5                 hardhat_1.3.0              </span></span>
<span><span class="co">## [239] beeswarm_0.4.0              prodlim_2023.08.28</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Lorenzo Bonaguro, Charlotte Kroeger, Sophie Mueller, Jacqueline Leidner.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
